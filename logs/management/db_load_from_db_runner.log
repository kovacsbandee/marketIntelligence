2025-08-30 12:09:06,637 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1 filtered rows from company_fundamentals
2025-08-30 12:09:06,644 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 20 filtered rows from balance_sheet_annual
2025-08-30 12:09:06,645 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'balance_sheet_annual' with 20 rows.
2025-08-30 12:09:06,648 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 20 filtered rows from cash_flow_annual
2025-08-30 12:09:06,650 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'cash_flow_annual' with 20 rows.
2025-08-30 12:09:06,652 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 30 filtered rows from earnings_annual
2025-08-30 12:09:06,653 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'earnings_annual' with 30 rows.
2025-08-30 12:09:06,657 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 20 filtered rows from income_statement_annual
2025-08-30 12:09:06,658 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'income_statement_annual' with 20 rows.
2025-08-30 12:09:06,660 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1 filtered rows from company_fundamentals
2025-08-30 12:09:06,662 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'company_fundamentals' with 1 rows.
2025-08-30 12:09:06,705 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 6497 filtered rows from daily_timeseries
2025-08-30 12:09:06,746 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'daily_timeseries' with 6497 rows.
2025-08-30 12:09:06,748 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from dividends
2025-08-30 12:09:06,754 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'dividends' with 0 rows.
2025-08-30 12:09:06,759 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 881 filtered rows from insider_transactions
2025-08-30 12:09:06,766 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'insider_transactions' with 881 rows.
2025-08-30 12:09:06,770 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 81 filtered rows from balance_sheet_quarterly
2025-08-30 12:09:06,773 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'balance_sheet_quarterly' with 81 rows.
2025-08-30 12:09:06,776 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from cash_flow_quarterly
2025-08-30 12:09:06,778 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'cash_flow_quarterly' with 0 rows.
2025-08-30 12:09:06,783 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 118 filtered rows from earnings_quarterly
2025-08-30 12:09:06,785 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'earnings_quarterly' with 118 rows.
2025-08-30 12:09:06,789 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 81 filtered rows from income_statement_quarterly
2025-08-30 12:09:06,792 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'income_statement_quarterly' with 81 rows.
2025-08-30 12:09:06,794 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 2 filtered rows from stock_splits
2025-08-30 12:09:06,795 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'stock_splits' with 2 rows.
2025-08-30 12:09:06,796 - db_load_from_db_runner - WARNING - symbol.py:184 - ORM class for table 'cash_flow_statement_quarterly' not found. Skipping.
2025-08-30 12:09:06,805 - db_load_from_db_runner - INFO - symbol.py:132 - Adjusted daily_timeseries for splits.
2025-08-30 12:09:06,895 - db_load_from_db_runner - INFO - symbol.py:246 - All price indicators added to daily_timeseries.
2025-08-30 12:09:20,311 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from company_fundamentals
2025-08-30 12:09:20,312 - db_load_from_db_runner - WARNING - symbol.py:158 - Symbol 'NVDA' not found in database. Attempting to load...
2025-08-30 12:09:20,312 - db_initial_load_runner - INFO - db_initial_load_runner.py:41 - Starting initial load for 1 symbols...
2025-08-30 12:09:20,312 - db_initial_load_runner - INFO - db_initial_load_runner.py:69 - Processing symbol: NVDA
2025-08-30 12:09:20,312 - AlphaLoader - INFO - alphavantage_adapter.py:88 - Fetching data for NVDA...
2025-08-30 12:09:21,857 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 6497 new rows into daily_timeseries
2025-08-30 12:09:21,859 - AlphaLoader - INFO - alphavantage_adapter.py:118 - Candlestick data for NVDA loaded into the database.
2025-08-30 12:09:21,859 - AlphaLoader - INFO - alphavantage_adapter.py:140 - Fetching company base data for NVDA...
2025-08-30 12:09:22,425 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 1 new rows into company_fundamentals
2025-08-30 12:09:22,430 - AlphaLoader - INFO - alphavantage_adapter.py:176 - Company base data for NVDA loaded into the database.
2025-08-30 12:09:22,430 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching INCOME_STATEMENT data for NVDA...
2025-08-30 12:09:23,270 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 20 new rows into income_statement_annual
2025-08-30 12:09:23,289 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 81 new rows into income_statement_quarterly
2025-08-30 12:09:23,294 - AlphaLoader - INFO - alphavantage_adapter.py:280 - INCOME_STATEMENT data for NVDA loaded into the database.
2025-08-30 12:09:23,294 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching BALANCE_SHEET data for NVDA...
2025-08-30 12:09:24,198 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 20 new rows into balance_sheet_annual
2025-08-30 12:09:24,211 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 81 new rows into balance_sheet_quarterly
2025-08-30 12:09:24,212 - AlphaLoader - INFO - alphavantage_adapter.py:280 - BALANCE_SHEET data for NVDA loaded into the database.
2025-08-30 12:09:24,212 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching CASH_FLOW data for NVDA...
2025-08-30 12:09:25,003 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 20 new rows into cash_flow_annual
2025-08-30 12:09:25,025 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into cash_flow_statement_quarterly
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "cash_flow_statement_quarterly_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(NVDA, 2025-04-30) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "cash_flow_statement_quarterly_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(NVDA, 2025-04-30) already exists.

[SQL: INSERT INTO cash_flow_statement_quarterly (symbol, fiscal_date_ending, reported_currency, operating_cashflow, payments_for_operating_activities, proceeds_from_operating_activities, change_in_operating_liabilities, change_in_operating_assets, deprecia ... 94030 characters truncated ... s, %(change_in_cash_and_cash_equivalents__80)s, %(change_in_exchange_rate__80)s, %(net_income__80)s)]
[parameters: {'dividend_payout_preferred_stock__0': nan, 'profit_loss__0': nan, 'change_in_operating_liabilities__0': nan, 'cashflow_from_financing__0': -11833000000, 'change_in_cash_and_cash_equivalents__0': nan, 'proceeds_from_operating_activities__0': nan, 'symbol__0': 'NVDA', 'payments_for_operating_activities__0': nan, 'depreciation_depletion_and_amortization__0': 669000000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__0': nan, 'proceeds_from_issuance_of_common_stock__0': nan, 'dividend_payout__0': 244000000.0, 'net_income__0': 26422000000, 'proceeds_from_sale_of_treasury_stock__0': nan, 'fiscal_date_ending__0': Timestamp('2025-07-31 00:00:00'), 'capital_expenditures__0': 1895000000, 'proceeds_from_issuance_of_preferred_stock__0': nan, 'operating_cashflow__0': 15365000000, 'change_in_receivables__0': nan, 'payments_for_repurchase_of_common_stock__0': nan, 'dividend_payout_common_stock__0': 244000000.0, 'change_in_exchange_rate__0': nan, 'proceeds_from_repurchase_of_equity__0': -9720000000, 'change_in_operating_assets__0': nan, 'change_in_inventory__0': -3622000000, 'proceeds_from_repayments_of_short_term_debt__0': nan, 'reported_currency__0': nan, 'payments_for_repurchase_of_equity__0': nan, 'cashflow_from_investment__0': -7127000000.0, 'payments_for_repurchase_of_preferred_stock__0': nan, 'dividend_payout_preferred_stock__1': nan, 'profit_loss__1': nan, 'change_in_operating_liabilities__1': nan, 'cashflow_from_financing__1': -15553000000, 'change_in_cash_and_cash_equivalents__1': nan, 'proceeds_from_operating_activities__1': nan, 'symbol__1': 'NVDA', 'payments_for_operating_activities__1': nan, 'depreciation_depletion_and_amortization__1': 611000000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__1': nan, 'proceeds_from_issuance_of_common_stock__1': nan, 'dividend_payout__1': 244000000.0, 'net_income__1': 18775000000, 'proceeds_from_sale_of_treasury_stock__1': nan, 'fiscal_date_ending__1': Timestamp('2025-04-30 00:00:00'), 'capital_expenditures__1': 1227000000, 'proceeds_from_issuance_of_preferred_stock__1': nan, 'operating_cashflow__1': 27414000000, 'change_in_receivables__1': nan, 'payments_for_repurchase_of_common_stock__1': nan ... 2330 parameters truncated ... 'proceeds_from_issuance_of_common_stock__79': nan, 'dividend_payout__79': nan, 'net_income__79': 64447000, 'proceeds_from_sale_of_treasury_stock__79': nan, 'fiscal_date_ending__79': Timestamp('2005-10-31 00:00:00'), 'capital_expenditures__79': 13466000, 'proceeds_from_issuance_of_preferred_stock__79': nan, 'operating_cashflow__79': 84099000, 'change_in_receivables__79': nan, 'payments_for_repurchase_of_common_stock__79': nan, 'dividend_payout_common_stock__79': nan, 'change_in_exchange_rate__79': nan, 'proceeds_from_repurchase_of_equity__79': -40000000, 'change_in_operating_assets__79': nan, 'change_in_inventory__79': 16108000, 'proceeds_from_repayments_of_short_term_debt__79': nan, 'reported_currency__79': 'USD', 'payments_for_repurchase_of_equity__79': nan, 'cashflow_from_investment__79': 29205000.0, 'payments_for_repurchase_of_preferred_stock__79': nan, 'dividend_payout_preferred_stock__80': nan, 'profit_loss__80': nan, 'change_in_operating_liabilities__80': nan, 'cashflow_from_financing__80': -30503000, 'change_in_cash_and_cash_equivalents__80': nan, 'proceeds_from_operating_activities__80': nan, 'symbol__80': 'NVDA', 'payments_for_operating_activities__80': nan, 'depreciation_depletion_and_amortization__80': 24770000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__80': nan, 'proceeds_from_issuance_of_common_stock__80': nan, 'dividend_payout__80': nan, 'net_income__80': 74911000, 'proceeds_from_sale_of_treasury_stock__80': nan, 'fiscal_date_ending__80': Timestamp('2005-07-31 00:00:00'), 'capital_expenditures__80': 29185000, 'proceeds_from_issuance_of_preferred_stock__80': nan, 'operating_cashflow__80': 47347000, 'change_in_receivables__80': nan, 'payments_for_repurchase_of_common_stock__80': nan, 'dividend_payout_common_stock__80': nan, 'change_in_exchange_rate__80': nan, 'proceeds_from_repurchase_of_equity__80': -50042000, 'change_in_operating_assets__80': nan, 'change_in_inventory__80': 6804000, 'proceeds_from_repayments_of_short_term_debt__80': nan, 'reported_currency__80': 'USD', 'payments_for_repurchase_of_equity__80': nan, 'cashflow_from_investment__80': -55678000.0, 'payments_for_repurchase_of_preferred_stock__80': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:09:25,032 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "cash_flow_statement_quarterly_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(NVDA, 2025-04-30) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "cash_flow_statement_quarterly_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(NVDA, 2025-04-30) already exists.

[SQL: INSERT INTO cash_flow_statement_quarterly (symbol, fiscal_date_ending, reported_currency, operating_cashflow, payments_for_operating_activities, proceeds_from_operating_activities, change_in_operating_liabilities, change_in_operating_assets, deprecia ... 94030 characters truncated ... s, %(change_in_cash_and_cash_equivalents__80)s, %(change_in_exchange_rate__80)s, %(net_income__80)s)]
[parameters: {'dividend_payout_preferred_stock__0': nan, 'profit_loss__0': nan, 'change_in_operating_liabilities__0': nan, 'cashflow_from_financing__0': -11833000000, 'change_in_cash_and_cash_equivalents__0': nan, 'proceeds_from_operating_activities__0': nan, 'symbol__0': 'NVDA', 'payments_for_operating_activities__0': nan, 'depreciation_depletion_and_amortization__0': 669000000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__0': nan, 'proceeds_from_issuance_of_common_stock__0': nan, 'dividend_payout__0': 244000000.0, 'net_income__0': 26422000000, 'proceeds_from_sale_of_treasury_stock__0': nan, 'fiscal_date_ending__0': Timestamp('2025-07-31 00:00:00'), 'capital_expenditures__0': 1895000000, 'proceeds_from_issuance_of_preferred_stock__0': nan, 'operating_cashflow__0': 15365000000, 'change_in_receivables__0': nan, 'payments_for_repurchase_of_common_stock__0': nan, 'dividend_payout_common_stock__0': 244000000.0, 'change_in_exchange_rate__0': nan, 'proceeds_from_repurchase_of_equity__0': -9720000000, 'change_in_operating_assets__0': nan, 'change_in_inventory__0': -3622000000, 'proceeds_from_repayments_of_short_term_debt__0': nan, 'reported_currency__0': nan, 'payments_for_repurchase_of_equity__0': nan, 'cashflow_from_investment__0': -7127000000.0, 'payments_for_repurchase_of_preferred_stock__0': nan, 'dividend_payout_preferred_stock__1': nan, 'profit_loss__1': nan, 'change_in_operating_liabilities__1': nan, 'cashflow_from_financing__1': -15553000000, 'change_in_cash_and_cash_equivalents__1': nan, 'proceeds_from_operating_activities__1': nan, 'symbol__1': 'NVDA', 'payments_for_operating_activities__1': nan, 'depreciation_depletion_and_amortization__1': 611000000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__1': nan, 'proceeds_from_issuance_of_common_stock__1': nan, 'dividend_payout__1': 244000000.0, 'net_income__1': 18775000000, 'proceeds_from_sale_of_treasury_stock__1': nan, 'fiscal_date_ending__1': Timestamp('2025-04-30 00:00:00'), 'capital_expenditures__1': 1227000000, 'proceeds_from_issuance_of_preferred_stock__1': nan, 'operating_cashflow__1': 27414000000, 'change_in_receivables__1': nan, 'payments_for_repurchase_of_common_stock__1': nan ... 2330 parameters truncated ... 'proceeds_from_issuance_of_common_stock__79': nan, 'dividend_payout__79': nan, 'net_income__79': 64447000, 'proceeds_from_sale_of_treasury_stock__79': nan, 'fiscal_date_ending__79': Timestamp('2005-10-31 00:00:00'), 'capital_expenditures__79': 13466000, 'proceeds_from_issuance_of_preferred_stock__79': nan, 'operating_cashflow__79': 84099000, 'change_in_receivables__79': nan, 'payments_for_repurchase_of_common_stock__79': nan, 'dividend_payout_common_stock__79': nan, 'change_in_exchange_rate__79': nan, 'proceeds_from_repurchase_of_equity__79': -40000000, 'change_in_operating_assets__79': nan, 'change_in_inventory__79': 16108000, 'proceeds_from_repayments_of_short_term_debt__79': nan, 'reported_currency__79': 'USD', 'payments_for_repurchase_of_equity__79': nan, 'cashflow_from_investment__79': 29205000.0, 'payments_for_repurchase_of_preferred_stock__79': nan, 'dividend_payout_preferred_stock__80': nan, 'profit_loss__80': nan, 'change_in_operating_liabilities__80': nan, 'cashflow_from_financing__80': -30503000, 'change_in_cash_and_cash_equivalents__80': nan, 'proceeds_from_operating_activities__80': nan, 'symbol__80': 'NVDA', 'payments_for_operating_activities__80': nan, 'depreciation_depletion_and_amortization__80': 24770000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__80': nan, 'proceeds_from_issuance_of_common_stock__80': nan, 'dividend_payout__80': nan, 'net_income__80': 74911000, 'proceeds_from_sale_of_treasury_stock__80': nan, 'fiscal_date_ending__80': Timestamp('2005-07-31 00:00:00'), 'capital_expenditures__80': 29185000, 'proceeds_from_issuance_of_preferred_stock__80': nan, 'operating_cashflow__80': 47347000, 'change_in_receivables__80': nan, 'payments_for_repurchase_of_common_stock__80': nan, 'dividend_payout_common_stock__80': nan, 'change_in_exchange_rate__80': nan, 'proceeds_from_repurchase_of_equity__80': -50042000, 'change_in_operating_assets__80': nan, 'change_in_inventory__80': 6804000, 'proceeds_from_repayments_of_short_term_debt__80': nan, 'reported_currency__80': 'USD', 'payments_for_repurchase_of_equity__80': nan, 'cashflow_from_investment__80': -55678000.0, 'payments_for_repurchase_of_preferred_stock__80': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:09:25,035 - AlphaLoader - ERROR - alphavantage_adapter.py:298 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "cash_flow_statement_quarterly_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(NVDA, 2025-04-30) already exists.

[SQL: INSERT INTO cash_flow_statement_quarterly (symbol, fiscal_date_ending, reported_currency, operating_cashflow, payments_for_operating_activities, proceeds_from_operating_activities, change_in_operating_liabilities, change_in_operating_assets, deprecia ... 94030 characters truncated ... s, %(change_in_cash_and_cash_equivalents__80)s, %(change_in_exchange_rate__80)s, %(net_income__80)s)]
[parameters: {'dividend_payout_preferred_stock__0': nan, 'profit_loss__0': nan, 'change_in_operating_liabilities__0': nan, 'cashflow_from_financing__0': -11833000000, 'change_in_cash_and_cash_equivalents__0': nan, 'proceeds_from_operating_activities__0': nan, 'symbol__0': 'NVDA', 'payments_for_operating_activities__0': nan, 'depreciation_depletion_and_amortization__0': 669000000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__0': nan, 'proceeds_from_issuance_of_common_stock__0': nan, 'dividend_payout__0': 244000000.0, 'net_income__0': 26422000000, 'proceeds_from_sale_of_treasury_stock__0': nan, 'fiscal_date_ending__0': Timestamp('2025-07-31 00:00:00'), 'capital_expenditures__0': 1895000000, 'proceeds_from_issuance_of_preferred_stock__0': nan, 'operating_cashflow__0': 15365000000, 'change_in_receivables__0': nan, 'payments_for_repurchase_of_common_stock__0': nan, 'dividend_payout_common_stock__0': 244000000.0, 'change_in_exchange_rate__0': nan, 'proceeds_from_repurchase_of_equity__0': -9720000000, 'change_in_operating_assets__0': nan, 'change_in_inventory__0': -3622000000, 'proceeds_from_repayments_of_short_term_debt__0': nan, 'reported_currency__0': nan, 'payments_for_repurchase_of_equity__0': nan, 'cashflow_from_investment__0': -7127000000.0, 'payments_for_repurchase_of_preferred_stock__0': nan, 'dividend_payout_preferred_stock__1': nan, 'profit_loss__1': nan, 'change_in_operating_liabilities__1': nan, 'cashflow_from_financing__1': -15553000000, 'change_in_cash_and_cash_equivalents__1': nan, 'proceeds_from_operating_activities__1': nan, 'symbol__1': 'NVDA', 'payments_for_operating_activities__1': nan, 'depreciation_depletion_and_amortization__1': 611000000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__1': nan, 'proceeds_from_issuance_of_common_stock__1': nan, 'dividend_payout__1': 244000000.0, 'net_income__1': 18775000000, 'proceeds_from_sale_of_treasury_stock__1': nan, 'fiscal_date_ending__1': Timestamp('2025-04-30 00:00:00'), 'capital_expenditures__1': 1227000000, 'proceeds_from_issuance_of_preferred_stock__1': nan, 'operating_cashflow__1': 27414000000, 'change_in_receivables__1': nan, 'payments_for_repurchase_of_common_stock__1': nan ... 2330 parameters truncated ... 'proceeds_from_issuance_of_common_stock__79': nan, 'dividend_payout__79': nan, 'net_income__79': 64447000, 'proceeds_from_sale_of_treasury_stock__79': nan, 'fiscal_date_ending__79': Timestamp('2005-10-31 00:00:00'), 'capital_expenditures__79': 13466000, 'proceeds_from_issuance_of_preferred_stock__79': nan, 'operating_cashflow__79': 84099000, 'change_in_receivables__79': nan, 'payments_for_repurchase_of_common_stock__79': nan, 'dividend_payout_common_stock__79': nan, 'change_in_exchange_rate__79': nan, 'proceeds_from_repurchase_of_equity__79': -40000000, 'change_in_operating_assets__79': nan, 'change_in_inventory__79': 16108000, 'proceeds_from_repayments_of_short_term_debt__79': nan, 'reported_currency__79': 'USD', 'payments_for_repurchase_of_equity__79': nan, 'cashflow_from_investment__79': 29205000.0, 'payments_for_repurchase_of_preferred_stock__79': nan, 'dividend_payout_preferred_stock__80': nan, 'profit_loss__80': nan, 'change_in_operating_liabilities__80': nan, 'cashflow_from_financing__80': -30503000, 'change_in_cash_and_cash_equivalents__80': nan, 'proceeds_from_operating_activities__80': nan, 'symbol__80': 'NVDA', 'payments_for_operating_activities__80': nan, 'depreciation_depletion_and_amortization__80': 24770000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__80': nan, 'proceeds_from_issuance_of_common_stock__80': nan, 'dividend_payout__80': nan, 'net_income__80': 74911000, 'proceeds_from_sale_of_treasury_stock__80': nan, 'fiscal_date_ending__80': Timestamp('2005-07-31 00:00:00'), 'capital_expenditures__80': 29185000, 'proceeds_from_issuance_of_preferred_stock__80': nan, 'operating_cashflow__80': 47347000, 'change_in_receivables__80': nan, 'payments_for_repurchase_of_common_stock__80': nan, 'dividend_payout_common_stock__80': nan, 'change_in_exchange_rate__80': nan, 'proceeds_from_repurchase_of_equity__80': -50042000, 'change_in_operating_assets__80': nan, 'change_in_inventory__80': 6804000, 'proceeds_from_repayments_of_short_term_debt__80': nan, 'reported_currency__80': 'USD', 'payments_for_repurchase_of_equity__80': nan, 'cashflow_from_investment__80': -55678000.0, 'payments_for_repurchase_of_preferred_stock__80': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:09:25,035 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching EARNINGS data for NVDA...
2025-08-30 12:09:25,383 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 27 new rows into earnings_annual
2025-08-30 12:09:25,395 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 106 new rows into earnings_quarterly
2025-08-30 12:09:25,397 - AlphaLoader - INFO - alphavantage_adapter.py:280 - EARNINGS data for NVDA loaded into the database.
2025-08-30 12:09:25,397 - AlphaLoader - INFO - alphavantage_adapter.py:305 - Fetching INSIDER_TRANSACTIONS data for NVDA...
2025-08-30 12:09:26,526 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 2456 new rows into insider_transactions
2025-08-30 12:09:26,528 - AlphaLoader - INFO - alphavantage_adapter.py:329 - Insider transaction data for NVDA loaded into the database.
2025-08-30 12:09:26,528 - AlphaLoader - INFO - alphavantage_adapter.py:352 - Fetching STOCK_SPLITS data for NVDA...
2025-08-30 12:09:26,826 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 6 new rows into stock_splits
2025-08-30 12:09:26,831 - AlphaLoader - INFO - alphavantage_adapter.py:375 - Stock split data for NVDA loaded into the database.
2025-08-30 12:09:26,831 - AlphaLoader - INFO - alphavantage_adapter.py:397 - Fetching DIVIDENDS data for NVDA...
2025-08-30 12:09:27,370 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into dividends
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: column "id" of relation "dividends" does not exist
LINE 1: INSERT INTO dividends (id, symbol, ex_dividend_date, amount,...
                               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "id" of relation "dividends" does not exist
LINE 1: INSERT INTO dividends (id, symbol, ex_dividend_date, amount,...
                               ^

[SQL: INSERT INTO dividends (id, symbol, ex_dividend_date, amount, declaration_date, record_date, payment_date) VALUES (nextval('dividends_id_seq'), %(symbol__0)s, %(ex_dividend_date__0)s, %(amount__0)s, %(declaration_date__0)s, %(record_date__0)s, %(payme ... 2545 characters truncated ... end_date__17)s, %(amount__17)s, %(declaration_date__17)s, %(record_date__17)s, %(payment_date__17)s)]
[parameters: {'record_date__0': datetime.date(2025, 9, 11), 'symbol__0': 'NVDA', 'declaration_date__0': datetime.date(2025, 8, 27), 'amount__0': 0.01, 'ex_dividend_date__0': datetime.date(2025, 9, 11), 'payment_date__0': datetime.date(2025, 10, 2), 'record_date__1': datetime.date(2025, 6, 11), 'symbol__1': 'NVDA', 'declaration_date__1': datetime.date(2025, 5, 28), 'amount__1': 0.01, 'ex_dividend_date__1': datetime.date(2025, 6, 11), 'payment_date__1': datetime.date(2025, 7, 3), 'record_date__2': datetime.date(2025, 3, 12), 'symbol__2': 'NVDA', 'declaration_date__2': datetime.date(2025, 2, 26), 'amount__2': 0.01, 'ex_dividend_date__2': datetime.date(2025, 3, 12), 'payment_date__2': datetime.date(2025, 4, 2), 'record_date__3': datetime.date(2024, 12, 5), 'symbol__3': 'NVDA', 'declaration_date__3': datetime.date(2024, 11, 20), 'amount__3': 0.01, 'ex_dividend_date__3': datetime.date(2024, 12, 5), 'payment_date__3': datetime.date(2024, 12, 27), 'record_date__4': datetime.date(2024, 9, 12), 'symbol__4': 'NVDA', 'declaration_date__4': datetime.date(2024, 8, 28), 'amount__4': 0.01, 'ex_dividend_date__4': datetime.date(2024, 9, 12), 'payment_date__4': datetime.date(2024, 10, 3), 'record_date__5': datetime.date(2024, 6, 11), 'symbol__5': 'NVDA', 'declaration_date__5': datetime.date(2024, 5, 22), 'amount__5': 0.01, 'ex_dividend_date__5': datetime.date(2024, 6, 11), 'payment_date__5': datetime.date(2024, 6, 28), 'record_date__6': datetime.date(2024, 5, 29), 'symbol__6': 'NVDA', 'declaration_date__6': datetime.date(2024, 5, 17), 'amount__6': 0.0, 'ex_dividend_date__6': datetime.date(2024, 5, 29), 'payment_date__6': datetime.date(2024, 6, 4), 'record_date__7': datetime.date(2024, 3, 6), 'symbol__7': 'NVDA', 'declaration_date__7': datetime.date(2024, 2, 21), 'amount__7': 0.04, 'ex_dividend_date__7': datetime.date(2024, 3, 5), 'payment_date__7': datetime.date(2024, 3, 27), 'record_date__8': datetime.date(2023, 12, 6), 'symbol__8': 'NVDA' ... 8 parameters truncated ... 'ex_dividend_date__9': datetime.date(2023, 9, 6), 'payment_date__9': datetime.date(2023, 9, 28), 'record_date__10': datetime.date(2023, 6, 8), 'symbol__10': 'NVDA', 'declaration_date__10': datetime.date(2023, 5, 24), 'amount__10': 0.04, 'ex_dividend_date__10': datetime.date(2023, 6, 7), 'payment_date__10': datetime.date(2023, 6, 30), 'record_date__11': datetime.date(2023, 3, 8), 'symbol__11': 'NVDA', 'declaration_date__11': datetime.date(2023, 2, 22), 'amount__11': 0.04, 'ex_dividend_date__11': datetime.date(2023, 3, 7), 'payment_date__11': datetime.date(2023, 3, 29), 'record_date__12': datetime.date(2022, 12, 1), 'symbol__12': 'NVDA', 'declaration_date__12': datetime.date(2022, 11, 16), 'amount__12': 0.04, 'ex_dividend_date__12': datetime.date(2022, 11, 30), 'payment_date__12': datetime.date(2022, 12, 22), 'record_date__13': datetime.date(2022, 9, 8), 'symbol__13': 'NVDA', 'declaration_date__13': datetime.date(2022, 8, 24), 'amount__13': 0.04, 'ex_dividend_date__13': datetime.date(2022, 9, 7), 'payment_date__13': datetime.date(2022, 9, 29), 'record_date__14': datetime.date(2022, 6, 9), 'symbol__14': 'NVDA', 'declaration_date__14': datetime.date(2022, 5, 25), 'amount__14': 0.04, 'ex_dividend_date__14': datetime.date(2022, 6, 8), 'payment_date__14': datetime.date(2022, 7, 1), 'record_date__15': datetime.date(2022, 3, 3), 'symbol__15': 'NVDA', 'declaration_date__15': datetime.date(2022, 2, 16), 'amount__15': 0.04, 'ex_dividend_date__15': datetime.date(2022, 3, 2), 'payment_date__15': datetime.date(2022, 3, 24), 'record_date__16': datetime.date(2021, 12, 2), 'symbol__16': 'NVDA', 'declaration_date__16': datetime.date(2021, 11, 17), 'amount__16': 0.04, 'ex_dividend_date__16': datetime.date(2021, 12, 1), 'payment_date__16': datetime.date(2021, 12, 23), 'record_date__17': datetime.date(2021, 9, 1), 'symbol__17': 'NVDA', 'declaration_date__17': datetime.date(2021, 8, 18), 'amount__17': 0.04, 'ex_dividend_date__17': datetime.date(2021, 8, 31), 'payment_date__17': datetime.date(2021, 9, 23)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-30 12:09:27,371 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedColumn: column "id" of relation "dividends" does not exist
LINE 1: INSERT INTO dividends (id, symbol, ex_dividend_date, amount,...
                               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "id" of relation "dividends" does not exist
LINE 1: INSERT INTO dividends (id, symbol, ex_dividend_date, amount,...
                               ^

[SQL: INSERT INTO dividends (id, symbol, ex_dividend_date, amount, declaration_date, record_date, payment_date) VALUES (nextval('dividends_id_seq'), %(symbol__0)s, %(ex_dividend_date__0)s, %(amount__0)s, %(declaration_date__0)s, %(record_date__0)s, %(payme ... 2545 characters truncated ... end_date__17)s, %(amount__17)s, %(declaration_date__17)s, %(record_date__17)s, %(payment_date__17)s)]
[parameters: {'record_date__0': datetime.date(2025, 9, 11), 'symbol__0': 'NVDA', 'declaration_date__0': datetime.date(2025, 8, 27), 'amount__0': 0.01, 'ex_dividend_date__0': datetime.date(2025, 9, 11), 'payment_date__0': datetime.date(2025, 10, 2), 'record_date__1': datetime.date(2025, 6, 11), 'symbol__1': 'NVDA', 'declaration_date__1': datetime.date(2025, 5, 28), 'amount__1': 0.01, 'ex_dividend_date__1': datetime.date(2025, 6, 11), 'payment_date__1': datetime.date(2025, 7, 3), 'record_date__2': datetime.date(2025, 3, 12), 'symbol__2': 'NVDA', 'declaration_date__2': datetime.date(2025, 2, 26), 'amount__2': 0.01, 'ex_dividend_date__2': datetime.date(2025, 3, 12), 'payment_date__2': datetime.date(2025, 4, 2), 'record_date__3': datetime.date(2024, 12, 5), 'symbol__3': 'NVDA', 'declaration_date__3': datetime.date(2024, 11, 20), 'amount__3': 0.01, 'ex_dividend_date__3': datetime.date(2024, 12, 5), 'payment_date__3': datetime.date(2024, 12, 27), 'record_date__4': datetime.date(2024, 9, 12), 'symbol__4': 'NVDA', 'declaration_date__4': datetime.date(2024, 8, 28), 'amount__4': 0.01, 'ex_dividend_date__4': datetime.date(2024, 9, 12), 'payment_date__4': datetime.date(2024, 10, 3), 'record_date__5': datetime.date(2024, 6, 11), 'symbol__5': 'NVDA', 'declaration_date__5': datetime.date(2024, 5, 22), 'amount__5': 0.01, 'ex_dividend_date__5': datetime.date(2024, 6, 11), 'payment_date__5': datetime.date(2024, 6, 28), 'record_date__6': datetime.date(2024, 5, 29), 'symbol__6': 'NVDA', 'declaration_date__6': datetime.date(2024, 5, 17), 'amount__6': 0.0, 'ex_dividend_date__6': datetime.date(2024, 5, 29), 'payment_date__6': datetime.date(2024, 6, 4), 'record_date__7': datetime.date(2024, 3, 6), 'symbol__7': 'NVDA', 'declaration_date__7': datetime.date(2024, 2, 21), 'amount__7': 0.04, 'ex_dividend_date__7': datetime.date(2024, 3, 5), 'payment_date__7': datetime.date(2024, 3, 27), 'record_date__8': datetime.date(2023, 12, 6), 'symbol__8': 'NVDA' ... 8 parameters truncated ... 'ex_dividend_date__9': datetime.date(2023, 9, 6), 'payment_date__9': datetime.date(2023, 9, 28), 'record_date__10': datetime.date(2023, 6, 8), 'symbol__10': 'NVDA', 'declaration_date__10': datetime.date(2023, 5, 24), 'amount__10': 0.04, 'ex_dividend_date__10': datetime.date(2023, 6, 7), 'payment_date__10': datetime.date(2023, 6, 30), 'record_date__11': datetime.date(2023, 3, 8), 'symbol__11': 'NVDA', 'declaration_date__11': datetime.date(2023, 2, 22), 'amount__11': 0.04, 'ex_dividend_date__11': datetime.date(2023, 3, 7), 'payment_date__11': datetime.date(2023, 3, 29), 'record_date__12': datetime.date(2022, 12, 1), 'symbol__12': 'NVDA', 'declaration_date__12': datetime.date(2022, 11, 16), 'amount__12': 0.04, 'ex_dividend_date__12': datetime.date(2022, 11, 30), 'payment_date__12': datetime.date(2022, 12, 22), 'record_date__13': datetime.date(2022, 9, 8), 'symbol__13': 'NVDA', 'declaration_date__13': datetime.date(2022, 8, 24), 'amount__13': 0.04, 'ex_dividend_date__13': datetime.date(2022, 9, 7), 'payment_date__13': datetime.date(2022, 9, 29), 'record_date__14': datetime.date(2022, 6, 9), 'symbol__14': 'NVDA', 'declaration_date__14': datetime.date(2022, 5, 25), 'amount__14': 0.04, 'ex_dividend_date__14': datetime.date(2022, 6, 8), 'payment_date__14': datetime.date(2022, 7, 1), 'record_date__15': datetime.date(2022, 3, 3), 'symbol__15': 'NVDA', 'declaration_date__15': datetime.date(2022, 2, 16), 'amount__15': 0.04, 'ex_dividend_date__15': datetime.date(2022, 3, 2), 'payment_date__15': datetime.date(2022, 3, 24), 'record_date__16': datetime.date(2021, 12, 2), 'symbol__16': 'NVDA', 'declaration_date__16': datetime.date(2021, 11, 17), 'amount__16': 0.04, 'ex_dividend_date__16': datetime.date(2021, 12, 1), 'payment_date__16': datetime.date(2021, 12, 23), 'record_date__17': datetime.date(2021, 9, 1), 'symbol__17': 'NVDA', 'declaration_date__17': datetime.date(2021, 8, 18), 'amount__17': 0.04, 'ex_dividend_date__17': datetime.date(2021, 8, 31), 'payment_date__17': datetime.date(2021, 9, 23)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-30 12:09:27,373 - AlphaLoader - ERROR - alphavantage_adapter.py:435 - An unexpected error occurred: (psycopg2.errors.UndefinedColumn) column "id" of relation "dividends" does not exist
LINE 1: INSERT INTO dividends (id, symbol, ex_dividend_date, amount,...
                               ^

[SQL: INSERT INTO dividends (id, symbol, ex_dividend_date, amount, declaration_date, record_date, payment_date) VALUES (nextval('dividends_id_seq'), %(symbol__0)s, %(ex_dividend_date__0)s, %(amount__0)s, %(declaration_date__0)s, %(record_date__0)s, %(payme ... 2545 characters truncated ... end_date__17)s, %(amount__17)s, %(declaration_date__17)s, %(record_date__17)s, %(payment_date__17)s)]
[parameters: {'record_date__0': datetime.date(2025, 9, 11), 'symbol__0': 'NVDA', 'declaration_date__0': datetime.date(2025, 8, 27), 'amount__0': 0.01, 'ex_dividend_date__0': datetime.date(2025, 9, 11), 'payment_date__0': datetime.date(2025, 10, 2), 'record_date__1': datetime.date(2025, 6, 11), 'symbol__1': 'NVDA', 'declaration_date__1': datetime.date(2025, 5, 28), 'amount__1': 0.01, 'ex_dividend_date__1': datetime.date(2025, 6, 11), 'payment_date__1': datetime.date(2025, 7, 3), 'record_date__2': datetime.date(2025, 3, 12), 'symbol__2': 'NVDA', 'declaration_date__2': datetime.date(2025, 2, 26), 'amount__2': 0.01, 'ex_dividend_date__2': datetime.date(2025, 3, 12), 'payment_date__2': datetime.date(2025, 4, 2), 'record_date__3': datetime.date(2024, 12, 5), 'symbol__3': 'NVDA', 'declaration_date__3': datetime.date(2024, 11, 20), 'amount__3': 0.01, 'ex_dividend_date__3': datetime.date(2024, 12, 5), 'payment_date__3': datetime.date(2024, 12, 27), 'record_date__4': datetime.date(2024, 9, 12), 'symbol__4': 'NVDA', 'declaration_date__4': datetime.date(2024, 8, 28), 'amount__4': 0.01, 'ex_dividend_date__4': datetime.date(2024, 9, 12), 'payment_date__4': datetime.date(2024, 10, 3), 'record_date__5': datetime.date(2024, 6, 11), 'symbol__5': 'NVDA', 'declaration_date__5': datetime.date(2024, 5, 22), 'amount__5': 0.01, 'ex_dividend_date__5': datetime.date(2024, 6, 11), 'payment_date__5': datetime.date(2024, 6, 28), 'record_date__6': datetime.date(2024, 5, 29), 'symbol__6': 'NVDA', 'declaration_date__6': datetime.date(2024, 5, 17), 'amount__6': 0.0, 'ex_dividend_date__6': datetime.date(2024, 5, 29), 'payment_date__6': datetime.date(2024, 6, 4), 'record_date__7': datetime.date(2024, 3, 6), 'symbol__7': 'NVDA', 'declaration_date__7': datetime.date(2024, 2, 21), 'amount__7': 0.04, 'ex_dividend_date__7': datetime.date(2024, 3, 5), 'payment_date__7': datetime.date(2024, 3, 27), 'record_date__8': datetime.date(2023, 12, 6), 'symbol__8': 'NVDA' ... 8 parameters truncated ... 'ex_dividend_date__9': datetime.date(2023, 9, 6), 'payment_date__9': datetime.date(2023, 9, 28), 'record_date__10': datetime.date(2023, 6, 8), 'symbol__10': 'NVDA', 'declaration_date__10': datetime.date(2023, 5, 24), 'amount__10': 0.04, 'ex_dividend_date__10': datetime.date(2023, 6, 7), 'payment_date__10': datetime.date(2023, 6, 30), 'record_date__11': datetime.date(2023, 3, 8), 'symbol__11': 'NVDA', 'declaration_date__11': datetime.date(2023, 2, 22), 'amount__11': 0.04, 'ex_dividend_date__11': datetime.date(2023, 3, 7), 'payment_date__11': datetime.date(2023, 3, 29), 'record_date__12': datetime.date(2022, 12, 1), 'symbol__12': 'NVDA', 'declaration_date__12': datetime.date(2022, 11, 16), 'amount__12': 0.04, 'ex_dividend_date__12': datetime.date(2022, 11, 30), 'payment_date__12': datetime.date(2022, 12, 22), 'record_date__13': datetime.date(2022, 9, 8), 'symbol__13': 'NVDA', 'declaration_date__13': datetime.date(2022, 8, 24), 'amount__13': 0.04, 'ex_dividend_date__13': datetime.date(2022, 9, 7), 'payment_date__13': datetime.date(2022, 9, 29), 'record_date__14': datetime.date(2022, 6, 9), 'symbol__14': 'NVDA', 'declaration_date__14': datetime.date(2022, 5, 25), 'amount__14': 0.04, 'ex_dividend_date__14': datetime.date(2022, 6, 8), 'payment_date__14': datetime.date(2022, 7, 1), 'record_date__15': datetime.date(2022, 3, 3), 'symbol__15': 'NVDA', 'declaration_date__15': datetime.date(2022, 2, 16), 'amount__15': 0.04, 'ex_dividend_date__15': datetime.date(2022, 3, 2), 'payment_date__15': datetime.date(2022, 3, 24), 'record_date__16': datetime.date(2021, 12, 2), 'symbol__16': 'NVDA', 'declaration_date__16': datetime.date(2021, 11, 17), 'amount__16': 0.04, 'ex_dividend_date__16': datetime.date(2021, 12, 1), 'payment_date__16': datetime.date(2021, 12, 23), 'record_date__17': datetime.date(2021, 9, 1), 'symbol__17': 'NVDA', 'declaration_date__17': datetime.date(2021, 8, 18), 'amount__17': 0.04, 'ex_dividend_date__17': datetime.date(2021, 8, 31), 'payment_date__17': datetime.date(2021, 9, 23)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-30 12:09:27,373 - db_initial_load_runner - INFO - db_initial_load_runner.py:77 - Initial loader finished its running.
2025-08-30 12:09:27,373 - db_load_from_db_runner - INFO - symbol.py:161 - Called load_stock_data for symbol: NVDA
2025-08-30 12:09:27,374 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1 filtered rows from company_fundamentals
2025-08-30 12:09:27,378 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 20 filtered rows from balance_sheet_annual
2025-08-30 12:09:27,379 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'balance_sheet_annual' with 20 rows.
2025-08-30 12:09:27,383 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 20 filtered rows from cash_flow_annual
2025-08-30 12:09:27,385 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'cash_flow_annual' with 20 rows.
2025-08-30 12:09:27,387 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 27 filtered rows from earnings_annual
2025-08-30 12:09:27,387 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'earnings_annual' with 27 rows.
2025-08-30 12:09:27,390 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 20 filtered rows from income_statement_annual
2025-08-30 12:09:27,391 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'income_statement_annual' with 20 rows.
2025-08-30 12:09:27,392 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1 filtered rows from company_fundamentals
2025-08-30 12:09:27,393 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'company_fundamentals' with 1 rows.
2025-08-30 12:09:27,433 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 6497 filtered rows from daily_timeseries
2025-08-30 12:09:27,463 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'daily_timeseries' with 6497 rows.
2025-08-30 12:09:27,465 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from dividends
2025-08-30 12:09:27,466 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'dividends' with 0 rows.
2025-08-30 12:09:27,477 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 2456 filtered rows from insider_transactions
2025-08-30 12:09:27,486 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'insider_transactions' with 2456 rows.
2025-08-30 12:09:27,488 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 81 filtered rows from balance_sheet_quarterly
2025-08-30 12:09:27,490 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'balance_sheet_quarterly' with 81 rows.
2025-08-30 12:09:27,493 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from cash_flow_quarterly
2025-08-30 12:09:27,494 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'cash_flow_quarterly' with 0 rows.
2025-08-30 12:09:27,496 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 106 filtered rows from earnings_quarterly
2025-08-30 12:09:27,498 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'earnings_quarterly' with 106 rows.
2025-08-30 12:09:27,502 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 81 filtered rows from income_statement_quarterly
2025-08-30 12:09:27,503 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'income_statement_quarterly' with 81 rows.
2025-08-30 12:09:27,505 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 6 filtered rows from stock_splits
2025-08-30 12:09:27,505 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'stock_splits' with 6 rows.
2025-08-30 12:09:27,506 - db_load_from_db_runner - WARNING - symbol.py:184 - ORM class for table 'cash_flow_statement_quarterly' not found. Skipping.
2025-08-30 12:09:27,517 - db_load_from_db_runner - INFO - symbol.py:132 - Adjusted daily_timeseries for splits.
2025-08-30 12:09:27,598 - db_load_from_db_runner - INFO - symbol.py:246 - All price indicators added to daily_timeseries.
2025-08-30 12:10:04,448 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from company_fundamentals
2025-08-30 12:10:04,449 - db_load_from_db_runner - WARNING - symbol.py:158 - Symbol 'GO' not found in database. Attempting to load...
2025-08-30 12:10:04,449 - db_initial_load_runner - INFO - db_initial_load_runner.py:41 - Starting initial load for 1 symbols...
2025-08-30 12:10:04,449 - db_initial_load_runner - INFO - db_initial_load_runner.py:69 - Processing symbol: GO
2025-08-30 12:10:04,449 - AlphaLoader - INFO - alphavantage_adapter.py:88 - Fetching data for GO...
2025-08-30 12:10:05,359 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into daily_timeseries
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "daily_timeseries_pkey"
DETAIL:  Key (date, symbol)=(2019-06-20, GO) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "daily_timeseries_pkey"
DETAIL:  Key (date, symbol)=(2019-06-20, GO) already exists.

[SQL: INSERT INTO daily_timeseries (date, symbol, open, high, low, close, volume) VALUES (%(date__0)s, %(symbol__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(date__1)s, %(symbol__1)s, %(open__1)s, %(high__1)s, %(low__1)s, %(c ... 109961 characters truncated ... 999)s, %(symbol__999)s, %(open__999)s, %(high__999)s, %(low__999)s, %(close__999)s, %(volume__999)s)]
[parameters: {'volume__0': '13395468', 'symbol__0': 'GO', 'close__0': '28.5100', 'date__0': Timestamp('2019-06-20 00:00:00'), 'high__0': '31.5000', 'low__0': '28.0000', 'open__0': '31.0000', 'volume__1': '1773046', 'symbol__1': 'GO', 'close__1': '28.6000', 'date__1': Timestamp('2019-06-21 00:00:00'), 'high__1': '29.9000', 'low__1': '27.8800', 'open__1': '29.7400', 'volume__2': '1085362', 'symbol__2': 'GO', 'close__2': '29.9900', 'date__2': Timestamp('2019-06-24 00:00:00'), 'high__2': '30.3899', 'low__2': '27.7500', 'open__2': '28.6100', 'volume__3': '788947', 'symbol__3': 'GO', 'close__3': '30.6900', 'date__3': Timestamp('2019-06-25 00:00:00'), 'high__3': '31.2925', 'low__3': '29.5990', 'open__3': '29.9000', 'volume__4': '2939229', 'symbol__4': 'GO', 'close__4': '32.9800', 'date__4': Timestamp('2019-06-26 00:00:00'), 'high__4': '35.6300', 'low__4': '31.0400', 'open__4': '31.4900', 'volume__5': '1057248', 'symbol__5': 'GO', 'close__5': '32.7100', 'date__5': Timestamp('2019-06-27 00:00:00'), 'high__5': '33.9500', 'low__5': '32.0500', 'open__5': '33.3100', 'volume__6': '541394', 'symbol__6': 'GO', 'close__6': '32.8800', 'date__6': Timestamp('2019-06-28 00:00:00'), 'high__6': '34.2000', 'low__6': '32.2732', 'open__6': '32.7400', 'volume__7': '1002913' ... 6900 parameters truncated ... 'open__992': '29.0600', 'volume__993': '855945', 'symbol__993': 'GO', 'close__993': '28.7200', 'date__993': Timestamp('2023-05-31 00:00:00'), 'high__993': '29.1300', 'low__993': '28.3900', 'open__993': '28.6500', 'volume__994': '824914', 'symbol__994': 'GO', 'close__994': '27.9700', 'date__994': Timestamp('2023-06-01 00:00:00'), 'high__994': '28.6175', 'low__994': '27.6950', 'open__994': '28.5200', 'volume__995': '907529', 'symbol__995': 'GO', 'close__995': '28.8600', 'date__995': Timestamp('2023-06-02 00:00:00'), 'high__995': '29.3700', 'low__995': '28.4200', 'open__995': '28.4800', 'volume__996': '1272669', 'symbol__996': 'GO', 'close__996': '27.8800', 'date__996': Timestamp('2023-06-05 00:00:00'), 'high__996': '28.7500', 'low__996': '27.8200', 'open__996': '28.6300', 'volume__997': '811221', 'symbol__997': 'GO', 'close__997': '28.7300', 'date__997': Timestamp('2023-06-06 00:00:00'), 'high__997': '28.7800', 'low__997': '27.7400', 'open__997': '27.8600', 'volume__998': '622249', 'symbol__998': 'GO', 'close__998': '28.5300', 'date__998': Timestamp('2023-06-07 00:00:00'), 'high__998': '28.8700', 'low__998': '28.2000', 'open__998': '28.6100', 'volume__999': '486370', 'symbol__999': 'GO', 'close__999': '28.3600', 'date__999': Timestamp('2023-06-08 00:00:00'), 'high__999': '28.7300', 'low__999': '28.2501', 'open__999': '28.5900'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:05,374 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "daily_timeseries_pkey"
DETAIL:  Key (date, symbol)=(2019-06-20, GO) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "daily_timeseries_pkey"
DETAIL:  Key (date, symbol)=(2019-06-20, GO) already exists.

[SQL: INSERT INTO daily_timeseries (date, symbol, open, high, low, close, volume) VALUES (%(date__0)s, %(symbol__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(date__1)s, %(symbol__1)s, %(open__1)s, %(high__1)s, %(low__1)s, %(c ... 109961 characters truncated ... 999)s, %(symbol__999)s, %(open__999)s, %(high__999)s, %(low__999)s, %(close__999)s, %(volume__999)s)]
[parameters: {'volume__0': '13395468', 'symbol__0': 'GO', 'close__0': '28.5100', 'date__0': Timestamp('2019-06-20 00:00:00'), 'high__0': '31.5000', 'low__0': '28.0000', 'open__0': '31.0000', 'volume__1': '1773046', 'symbol__1': 'GO', 'close__1': '28.6000', 'date__1': Timestamp('2019-06-21 00:00:00'), 'high__1': '29.9000', 'low__1': '27.8800', 'open__1': '29.7400', 'volume__2': '1085362', 'symbol__2': 'GO', 'close__2': '29.9900', 'date__2': Timestamp('2019-06-24 00:00:00'), 'high__2': '30.3899', 'low__2': '27.7500', 'open__2': '28.6100', 'volume__3': '788947', 'symbol__3': 'GO', 'close__3': '30.6900', 'date__3': Timestamp('2019-06-25 00:00:00'), 'high__3': '31.2925', 'low__3': '29.5990', 'open__3': '29.9000', 'volume__4': '2939229', 'symbol__4': 'GO', 'close__4': '32.9800', 'date__4': Timestamp('2019-06-26 00:00:00'), 'high__4': '35.6300', 'low__4': '31.0400', 'open__4': '31.4900', 'volume__5': '1057248', 'symbol__5': 'GO', 'close__5': '32.7100', 'date__5': Timestamp('2019-06-27 00:00:00'), 'high__5': '33.9500', 'low__5': '32.0500', 'open__5': '33.3100', 'volume__6': '541394', 'symbol__6': 'GO', 'close__6': '32.8800', 'date__6': Timestamp('2019-06-28 00:00:00'), 'high__6': '34.2000', 'low__6': '32.2732', 'open__6': '32.7400', 'volume__7': '1002913' ... 6900 parameters truncated ... 'open__992': '29.0600', 'volume__993': '855945', 'symbol__993': 'GO', 'close__993': '28.7200', 'date__993': Timestamp('2023-05-31 00:00:00'), 'high__993': '29.1300', 'low__993': '28.3900', 'open__993': '28.6500', 'volume__994': '824914', 'symbol__994': 'GO', 'close__994': '27.9700', 'date__994': Timestamp('2023-06-01 00:00:00'), 'high__994': '28.6175', 'low__994': '27.6950', 'open__994': '28.5200', 'volume__995': '907529', 'symbol__995': 'GO', 'close__995': '28.8600', 'date__995': Timestamp('2023-06-02 00:00:00'), 'high__995': '29.3700', 'low__995': '28.4200', 'open__995': '28.4800', 'volume__996': '1272669', 'symbol__996': 'GO', 'close__996': '27.8800', 'date__996': Timestamp('2023-06-05 00:00:00'), 'high__996': '28.7500', 'low__996': '27.8200', 'open__996': '28.6300', 'volume__997': '811221', 'symbol__997': 'GO', 'close__997': '28.7300', 'date__997': Timestamp('2023-06-06 00:00:00'), 'high__997': '28.7800', 'low__997': '27.7400', 'open__997': '27.8600', 'volume__998': '622249', 'symbol__998': 'GO', 'close__998': '28.5300', 'date__998': Timestamp('2023-06-07 00:00:00'), 'high__998': '28.8700', 'low__998': '28.2000', 'open__998': '28.6100', 'volume__999': '486370', 'symbol__999': 'GO', 'close__999': '28.3600', 'date__999': Timestamp('2023-06-08 00:00:00'), 'high__999': '28.7300', 'low__999': '28.2501', 'open__999': '28.5900'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:05,376 - AlphaLoader - ERROR - alphavantage_adapter.py:132 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "daily_timeseries_pkey"
DETAIL:  Key (date, symbol)=(2019-06-20, GO) already exists.

[SQL: INSERT INTO daily_timeseries (date, symbol, open, high, low, close, volume) VALUES (%(date__0)s, %(symbol__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s), (%(date__1)s, %(symbol__1)s, %(open__1)s, %(high__1)s, %(low__1)s, %(c ... 109961 characters truncated ... 999)s, %(symbol__999)s, %(open__999)s, %(high__999)s, %(low__999)s, %(close__999)s, %(volume__999)s)]
[parameters: {'volume__0': '13395468', 'symbol__0': 'GO', 'close__0': '28.5100', 'date__0': Timestamp('2019-06-20 00:00:00'), 'high__0': '31.5000', 'low__0': '28.0000', 'open__0': '31.0000', 'volume__1': '1773046', 'symbol__1': 'GO', 'close__1': '28.6000', 'date__1': Timestamp('2019-06-21 00:00:00'), 'high__1': '29.9000', 'low__1': '27.8800', 'open__1': '29.7400', 'volume__2': '1085362', 'symbol__2': 'GO', 'close__2': '29.9900', 'date__2': Timestamp('2019-06-24 00:00:00'), 'high__2': '30.3899', 'low__2': '27.7500', 'open__2': '28.6100', 'volume__3': '788947', 'symbol__3': 'GO', 'close__3': '30.6900', 'date__3': Timestamp('2019-06-25 00:00:00'), 'high__3': '31.2925', 'low__3': '29.5990', 'open__3': '29.9000', 'volume__4': '2939229', 'symbol__4': 'GO', 'close__4': '32.9800', 'date__4': Timestamp('2019-06-26 00:00:00'), 'high__4': '35.6300', 'low__4': '31.0400', 'open__4': '31.4900', 'volume__5': '1057248', 'symbol__5': 'GO', 'close__5': '32.7100', 'date__5': Timestamp('2019-06-27 00:00:00'), 'high__5': '33.9500', 'low__5': '32.0500', 'open__5': '33.3100', 'volume__6': '541394', 'symbol__6': 'GO', 'close__6': '32.8800', 'date__6': Timestamp('2019-06-28 00:00:00'), 'high__6': '34.2000', 'low__6': '32.2732', 'open__6': '32.7400', 'volume__7': '1002913' ... 6900 parameters truncated ... 'open__992': '29.0600', 'volume__993': '855945', 'symbol__993': 'GO', 'close__993': '28.7200', 'date__993': Timestamp('2023-05-31 00:00:00'), 'high__993': '29.1300', 'low__993': '28.3900', 'open__993': '28.6500', 'volume__994': '824914', 'symbol__994': 'GO', 'close__994': '27.9700', 'date__994': Timestamp('2023-06-01 00:00:00'), 'high__994': '28.6175', 'low__994': '27.6950', 'open__994': '28.5200', 'volume__995': '907529', 'symbol__995': 'GO', 'close__995': '28.8600', 'date__995': Timestamp('2023-06-02 00:00:00'), 'high__995': '29.3700', 'low__995': '28.4200', 'open__995': '28.4800', 'volume__996': '1272669', 'symbol__996': 'GO', 'close__996': '27.8800', 'date__996': Timestamp('2023-06-05 00:00:00'), 'high__996': '28.7500', 'low__996': '27.8200', 'open__996': '28.6300', 'volume__997': '811221', 'symbol__997': 'GO', 'close__997': '28.7300', 'date__997': Timestamp('2023-06-06 00:00:00'), 'high__997': '28.7800', 'low__997': '27.7400', 'open__997': '27.8600', 'volume__998': '622249', 'symbol__998': 'GO', 'close__998': '28.5300', 'date__998': Timestamp('2023-06-07 00:00:00'), 'high__998': '28.8700', 'low__998': '28.2000', 'open__998': '28.6100', 'volume__999': '486370', 'symbol__999': 'GO', 'close__999': '28.3600', 'date__999': Timestamp('2023-06-08 00:00:00'), 'high__999': '28.7300', 'low__999': '28.2501', 'open__999': '28.5900'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:05,376 - AlphaLoader - INFO - alphavantage_adapter.py:140 - Fetching company base data for GO...
2025-08-30 12:10:05,602 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - INFO - postgre_adapter.py:242 - Inserted 1 new rows into company_fundamentals
2025-08-30 12:10:05,605 - AlphaLoader - INFO - alphavantage_adapter.py:176 - Company base data for GO loaded into the database.
2025-08-30 12:10:05,605 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching INCOME_STATEMENT data for GO...
2025-08-30 12:10:06,066 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into income_statement_annual
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "income_statement_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "income_statement_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO income_statement_annual (symbol, fiscal_date_ending, reported_currency, gross_profit, total_revenue, cost_of_revenue, cost_of_goods_and_services_sold, operating_income, selling_general_and_administrative, research_and_development, operati ... 7041 characters truncated ... rations__8)s, %(comprehensive_income_net_of_tax__8)s, %(ebit__8)s, %(ebitda__8)s, %(net_income__8)s)]
[parameters: {'depreciation__0': nan, 'comprehensive_income_net_of_tax__0': nan, 'ebit__0': 85023000, 'other_non_operating_income__0': nan, 'income_before_tax__0': 56171000, 'operating_expenses__0': 1243610000, 'symbol__0': 'GO', 'net_income_from_continuing_operations__0': 39465000, 'ebitda__0': 193229000, 'selling_general_and_administrative__0': 1176091000, 'operating_income__0': 78327000, 'total_revenue__0': 4371501000, 'interest_and_debt_expense__0': nan, 'net_income__0': 39465000, 'cost_of_goods_and_services_sold__0': 3049564000, 'investment_income_net__0': nan, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'net_interest_income__0': -22156000, 'research_and_development__0': nan, 'interest_income__0': 6723000, 'cost_of_revenue__0': 3049564000, 'income_tax_expense__0': 16706000, 'non_interest_income__0': nan, 'interest_expense__0': 28852000, 'gross_profit__0': 1321937000, 'reported_currency__0': 'USD', 'depreciation_and_amortization__0': 108206000, 'depreciation__1': nan, 'comprehensive_income_net_of_tax__1': nan, 'ebit__1': 126989000, 'other_non_operating_income__1': nan, 'income_before_tax__1': 104081000, 'operating_expenses__1': 1115897000, 'symbol__1': 'GO', 'net_income_from_continuing_operations__1': 81220000, 'ebitda__1': 214971000, 'selling_general_and_administrative__1': 1079038000, 'operating_income__1': 125782000, 'total_revenue__1': 3969453000, 'interest_and_debt_expense__1': nan, 'net_income__1': 79437000, 'cost_of_goods_and_services_sold__1': 2727774000, 'investment_income_net__1': nan, 'fiscal_date_ending__1': Timestamp('2023-12-31 00:00:00'), 'net_interest_income__1': -20523000, 'research_and_development__1': nan, 'interest_income__1': 6444000, 'cost_of_revenue__1': 2727774000, 'income_tax_expense__1': 24644000, 'non_interest_income__1': nan ... 143 parameters truncated ... 'income_before_tax__7': 25772000, 'operating_expenses__7': 554947000, 'symbol__7': 'GO', 'net_income_from_continuing_operations__7': 20601000, 'ebitda__7': 120092000, 'selling_general_and_administrative__7': 511795000, 'operating_income__7': 76936000, 'total_revenue__7': 2075465000, 'interest_and_debt_expense__7': nan, 'net_income__7': 20601000, 'cost_of_goods_and_services_sold__7': 1443582000, 'investment_income_net__7': nan, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'net_interest_income__7': -49698000, 'research_and_development__7': 0.0, 'interest_income__7': 1131000, 'cost_of_revenue__7': 1443582000, 'income_tax_expense__7': 5171000, 'non_interest_income__7': nan, 'interest_expense__7': 50829000, 'gross_profit__7': 631883000, 'reported_currency__7': 'USD', 'depreciation_and_amortization__7': 43156000, 'depreciation__8': nan, 'comprehensive_income_net_of_tax__8': nan, 'ebit__8': 64069000, 'other_non_operating_income__8': nan, 'income_before_tax__8': 16922000, 'operating_expenses__8': 497108000, 'symbol__8': 'GO', 'net_income_from_continuing_operations__8': 10198000, 'ebitda__8': 101221000, 'selling_general_and_administrative__8': 459956000, 'operating_income__8': 64069000, 'total_revenue__8': 1831531000, 'interest_and_debt_expense__8': nan, 'net_income__8': 10198000, 'cost_of_goods_and_services_sold__8': 1270354000, 'investment_income_net__8': nan, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'net_interest_income__8': -47147000, 'research_and_development__8': 0.0, 'interest_income__8': 961000, 'cost_of_revenue__8': 1270354000, 'income_tax_expense__8': 6724000, 'non_interest_income__8': nan, 'interest_expense__8': 48108000, 'gross_profit__8': 561177000, 'reported_currency__8': 'USD', 'depreciation_and_amortization__8': 37152000}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,069 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "income_statement_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "income_statement_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO income_statement_annual (symbol, fiscal_date_ending, reported_currency, gross_profit, total_revenue, cost_of_revenue, cost_of_goods_and_services_sold, operating_income, selling_general_and_administrative, research_and_development, operati ... 7041 characters truncated ... rations__8)s, %(comprehensive_income_net_of_tax__8)s, %(ebit__8)s, %(ebitda__8)s, %(net_income__8)s)]
[parameters: {'depreciation__0': nan, 'comprehensive_income_net_of_tax__0': nan, 'ebit__0': 85023000, 'other_non_operating_income__0': nan, 'income_before_tax__0': 56171000, 'operating_expenses__0': 1243610000, 'symbol__0': 'GO', 'net_income_from_continuing_operations__0': 39465000, 'ebitda__0': 193229000, 'selling_general_and_administrative__0': 1176091000, 'operating_income__0': 78327000, 'total_revenue__0': 4371501000, 'interest_and_debt_expense__0': nan, 'net_income__0': 39465000, 'cost_of_goods_and_services_sold__0': 3049564000, 'investment_income_net__0': nan, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'net_interest_income__0': -22156000, 'research_and_development__0': nan, 'interest_income__0': 6723000, 'cost_of_revenue__0': 3049564000, 'income_tax_expense__0': 16706000, 'non_interest_income__0': nan, 'interest_expense__0': 28852000, 'gross_profit__0': 1321937000, 'reported_currency__0': 'USD', 'depreciation_and_amortization__0': 108206000, 'depreciation__1': nan, 'comprehensive_income_net_of_tax__1': nan, 'ebit__1': 126989000, 'other_non_operating_income__1': nan, 'income_before_tax__1': 104081000, 'operating_expenses__1': 1115897000, 'symbol__1': 'GO', 'net_income_from_continuing_operations__1': 81220000, 'ebitda__1': 214971000, 'selling_general_and_administrative__1': 1079038000, 'operating_income__1': 125782000, 'total_revenue__1': 3969453000, 'interest_and_debt_expense__1': nan, 'net_income__1': 79437000, 'cost_of_goods_and_services_sold__1': 2727774000, 'investment_income_net__1': nan, 'fiscal_date_ending__1': Timestamp('2023-12-31 00:00:00'), 'net_interest_income__1': -20523000, 'research_and_development__1': nan, 'interest_income__1': 6444000, 'cost_of_revenue__1': 2727774000, 'income_tax_expense__1': 24644000, 'non_interest_income__1': nan ... 143 parameters truncated ... 'income_before_tax__7': 25772000, 'operating_expenses__7': 554947000, 'symbol__7': 'GO', 'net_income_from_continuing_operations__7': 20601000, 'ebitda__7': 120092000, 'selling_general_and_administrative__7': 511795000, 'operating_income__7': 76936000, 'total_revenue__7': 2075465000, 'interest_and_debt_expense__7': nan, 'net_income__7': 20601000, 'cost_of_goods_and_services_sold__7': 1443582000, 'investment_income_net__7': nan, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'net_interest_income__7': -49698000, 'research_and_development__7': 0.0, 'interest_income__7': 1131000, 'cost_of_revenue__7': 1443582000, 'income_tax_expense__7': 5171000, 'non_interest_income__7': nan, 'interest_expense__7': 50829000, 'gross_profit__7': 631883000, 'reported_currency__7': 'USD', 'depreciation_and_amortization__7': 43156000, 'depreciation__8': nan, 'comprehensive_income_net_of_tax__8': nan, 'ebit__8': 64069000, 'other_non_operating_income__8': nan, 'income_before_tax__8': 16922000, 'operating_expenses__8': 497108000, 'symbol__8': 'GO', 'net_income_from_continuing_operations__8': 10198000, 'ebitda__8': 101221000, 'selling_general_and_administrative__8': 459956000, 'operating_income__8': 64069000, 'total_revenue__8': 1831531000, 'interest_and_debt_expense__8': nan, 'net_income__8': 10198000, 'cost_of_goods_and_services_sold__8': 1270354000, 'investment_income_net__8': nan, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'net_interest_income__8': -47147000, 'research_and_development__8': 0.0, 'interest_income__8': 961000, 'cost_of_revenue__8': 1270354000, 'income_tax_expense__8': 6724000, 'non_interest_income__8': nan, 'interest_expense__8': 48108000, 'gross_profit__8': 561177000, 'reported_currency__8': 'USD', 'depreciation_and_amortization__8': 37152000}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,072 - AlphaLoader - ERROR - alphavantage_adapter.py:298 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "income_statement_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO income_statement_annual (symbol, fiscal_date_ending, reported_currency, gross_profit, total_revenue, cost_of_revenue, cost_of_goods_and_services_sold, operating_income, selling_general_and_administrative, research_and_development, operati ... 7041 characters truncated ... rations__8)s, %(comprehensive_income_net_of_tax__8)s, %(ebit__8)s, %(ebitda__8)s, %(net_income__8)s)]
[parameters: {'depreciation__0': nan, 'comprehensive_income_net_of_tax__0': nan, 'ebit__0': 85023000, 'other_non_operating_income__0': nan, 'income_before_tax__0': 56171000, 'operating_expenses__0': 1243610000, 'symbol__0': 'GO', 'net_income_from_continuing_operations__0': 39465000, 'ebitda__0': 193229000, 'selling_general_and_administrative__0': 1176091000, 'operating_income__0': 78327000, 'total_revenue__0': 4371501000, 'interest_and_debt_expense__0': nan, 'net_income__0': 39465000, 'cost_of_goods_and_services_sold__0': 3049564000, 'investment_income_net__0': nan, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'net_interest_income__0': -22156000, 'research_and_development__0': nan, 'interest_income__0': 6723000, 'cost_of_revenue__0': 3049564000, 'income_tax_expense__0': 16706000, 'non_interest_income__0': nan, 'interest_expense__0': 28852000, 'gross_profit__0': 1321937000, 'reported_currency__0': 'USD', 'depreciation_and_amortization__0': 108206000, 'depreciation__1': nan, 'comprehensive_income_net_of_tax__1': nan, 'ebit__1': 126989000, 'other_non_operating_income__1': nan, 'income_before_tax__1': 104081000, 'operating_expenses__1': 1115897000, 'symbol__1': 'GO', 'net_income_from_continuing_operations__1': 81220000, 'ebitda__1': 214971000, 'selling_general_and_administrative__1': 1079038000, 'operating_income__1': 125782000, 'total_revenue__1': 3969453000, 'interest_and_debt_expense__1': nan, 'net_income__1': 79437000, 'cost_of_goods_and_services_sold__1': 2727774000, 'investment_income_net__1': nan, 'fiscal_date_ending__1': Timestamp('2023-12-31 00:00:00'), 'net_interest_income__1': -20523000, 'research_and_development__1': nan, 'interest_income__1': 6444000, 'cost_of_revenue__1': 2727774000, 'income_tax_expense__1': 24644000, 'non_interest_income__1': nan ... 143 parameters truncated ... 'income_before_tax__7': 25772000, 'operating_expenses__7': 554947000, 'symbol__7': 'GO', 'net_income_from_continuing_operations__7': 20601000, 'ebitda__7': 120092000, 'selling_general_and_administrative__7': 511795000, 'operating_income__7': 76936000, 'total_revenue__7': 2075465000, 'interest_and_debt_expense__7': nan, 'net_income__7': 20601000, 'cost_of_goods_and_services_sold__7': 1443582000, 'investment_income_net__7': nan, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'net_interest_income__7': -49698000, 'research_and_development__7': 0.0, 'interest_income__7': 1131000, 'cost_of_revenue__7': 1443582000, 'income_tax_expense__7': 5171000, 'non_interest_income__7': nan, 'interest_expense__7': 50829000, 'gross_profit__7': 631883000, 'reported_currency__7': 'USD', 'depreciation_and_amortization__7': 43156000, 'depreciation__8': nan, 'comprehensive_income_net_of_tax__8': nan, 'ebit__8': 64069000, 'other_non_operating_income__8': nan, 'income_before_tax__8': 16922000, 'operating_expenses__8': 497108000, 'symbol__8': 'GO', 'net_income_from_continuing_operations__8': 10198000, 'ebitda__8': 101221000, 'selling_general_and_administrative__8': 459956000, 'operating_income__8': 64069000, 'total_revenue__8': 1831531000, 'interest_and_debt_expense__8': nan, 'net_income__8': 10198000, 'cost_of_goods_and_services_sold__8': 1270354000, 'investment_income_net__8': nan, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'net_interest_income__8': -47147000, 'research_and_development__8': 0.0, 'interest_income__8': 961000, 'cost_of_revenue__8': 1270354000, 'income_tax_expense__8': 6724000, 'non_interest_income__8': nan, 'interest_expense__8': 48108000, 'gross_profit__8': 561177000, 'reported_currency__8': 'USD', 'depreciation_and_amortization__8': 37152000}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,072 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching BALANCE_SHEET data for GO...
2025-08-30 12:10:06,429 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into balance_sheet_annual
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "balance_sheet_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "balance_sheet_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO balance_sheet_annual (symbol, fiscal_date_ending, reported_currency, total_assets, total_current_assets, cash_and_cash_equivalents, cash_and_short_term_investments, inventory, current_net_receivables, total_non_current_assets, property_pl ... 9782 characters truncated ... y_stock__8)s, %(retained_earnings__8)s, %(common_stock__8)s, %(common_stock_shares_outstanding__8)s)]
[parameters: {'cash_and_cash_equivalents__0': 62828000, 'current_net_receivables__0': 20217000.0, 'other_current_assets__0': 26701000, 'retained_earnings__0': 381429000, 'short_long_term_debt_total__0': 1656626000.0, 'total_liabilities__0': 1976437000, 'total_non_current_liabilities__0': 1626813000.0, 'common_stock_shares_outstanding__0': 99615000, 'property_plant_equipment__0': nan, 'inventory__0': 394152000, 'symbol__0': 'GO', 'short_term_investments__0': nan, 'cash_and_short_term_investments__0': 62828000, 'long_term_investments__0': nan, 'total_non_current_assets__0': 2669923000.0, 'total_current_liabilities__0': 349624000, 'total_assets__0': 3173821000, 'other_non_current_assets__0': nan, 'total_current_assets__0': 503898000, 'current_debt__0': nan, 'short_term_debt__0': 87905000, 'common_stock__0': 97000, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'treasury_stock__0': nan, 'deferred_revenue__0': nan, 'accumulated_depreciation_amortization_ppe__0': nan, 'goodwill__0': 782734000, 'long_term_debt__0': 462502000, 'current_accounts_payable__0': 175871000, 'total_shareholder_equity__0': 1197384000, 'other_non_current_liabilities__0': 1914000.0, 'other_current_liabilities__0': 74927000, 'intangible_assets__0': 78778000, 'reported_currency__0': 'USD', 'capital_lease_obligations__0': 1179124000.0, 'cash_and_cash_equivalents__1': 114987000, 'current_net_receivables__1': 19128000.0, 'other_current_assets__1': 32443000, 'retained_earnings__1': 341964000, 'short_long_term_debt_total__1': 1394813000.0, 'total_liabilities__1': 1750247000, 'total_non_current_liabilities__1': 1366282000.0, 'common_stock_shares_outstanding__1': 100831000, 'property_plant_equipment__1': nan, 'inventory__1': 349993000, 'symbol__1': 'GO', 'short_term_investments__1': nan, 'cash_and_short_term_investments__1': 114987000, 'long_term_investments__1': nan, 'total_non_current_assets__1': 2453035000.0 ... 215 parameters truncated ... 'short_term_debt__7': 5384000, 'common_stock__7': 68000, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'treasury_stock__7': 0.0, 'deferred_revenue__7': nan, 'accumulated_depreciation_amortization_ppe__7': nan, 'goodwill__7': 747943000, 'long_term_debt__7': 705502000, 'current_accounts_payable__7': 95555000, 'total_shareholder_equity__7': 427133000, 'other_non_current_liabilities__7': nan, 'other_current_liabilities__7': 27367000, 'intangible_assets__7': 75664000, 'reported_currency__7': 'USD', 'capital_lease_obligations__7': nan, 'cash_and_cash_equivalents__8': 0, 'current_net_receivables__8': nan, 'other_current_assets__8': 0, 'retained_earnings__8': 0, 'short_long_term_debt_total__8': nan, 'total_liabilities__8': 0, 'total_non_current_liabilities__8': nan, 'common_stock_shares_outstanding__8': 74221000, 'property_plant_equipment__8': 0.0, 'inventory__8': 0, 'symbol__8': 'GO', 'short_term_investments__8': 0.0, 'cash_and_short_term_investments__8': 0, 'long_term_investments__8': 0.0, 'total_non_current_assets__8': nan, 'total_current_liabilities__8': 0, 'total_assets__8': 0, 'other_non_current_assets__8': nan, 'total_current_assets__8': 0, 'current_debt__8': nan, 'short_term_debt__8': 0, 'common_stock__8': 0, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'treasury_stock__8': 0.0, 'deferred_revenue__8': nan, 'accumulated_depreciation_amortization_ppe__8': nan, 'goodwill__8': 0, 'long_term_debt__8': 0, 'current_accounts_payable__8': 0, 'total_shareholder_equity__8': 0, 'other_non_current_liabilities__8': nan, 'other_current_liabilities__8': 0, 'intangible_assets__8': 0, 'reported_currency__8': 'USD', 'capital_lease_obligations__8': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,431 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "balance_sheet_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "balance_sheet_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO balance_sheet_annual (symbol, fiscal_date_ending, reported_currency, total_assets, total_current_assets, cash_and_cash_equivalents, cash_and_short_term_investments, inventory, current_net_receivables, total_non_current_assets, property_pl ... 9782 characters truncated ... y_stock__8)s, %(retained_earnings__8)s, %(common_stock__8)s, %(common_stock_shares_outstanding__8)s)]
[parameters: {'cash_and_cash_equivalents__0': 62828000, 'current_net_receivables__0': 20217000.0, 'other_current_assets__0': 26701000, 'retained_earnings__0': 381429000, 'short_long_term_debt_total__0': 1656626000.0, 'total_liabilities__0': 1976437000, 'total_non_current_liabilities__0': 1626813000.0, 'common_stock_shares_outstanding__0': 99615000, 'property_plant_equipment__0': nan, 'inventory__0': 394152000, 'symbol__0': 'GO', 'short_term_investments__0': nan, 'cash_and_short_term_investments__0': 62828000, 'long_term_investments__0': nan, 'total_non_current_assets__0': 2669923000.0, 'total_current_liabilities__0': 349624000, 'total_assets__0': 3173821000, 'other_non_current_assets__0': nan, 'total_current_assets__0': 503898000, 'current_debt__0': nan, 'short_term_debt__0': 87905000, 'common_stock__0': 97000, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'treasury_stock__0': nan, 'deferred_revenue__0': nan, 'accumulated_depreciation_amortization_ppe__0': nan, 'goodwill__0': 782734000, 'long_term_debt__0': 462502000, 'current_accounts_payable__0': 175871000, 'total_shareholder_equity__0': 1197384000, 'other_non_current_liabilities__0': 1914000.0, 'other_current_liabilities__0': 74927000, 'intangible_assets__0': 78778000, 'reported_currency__0': 'USD', 'capital_lease_obligations__0': 1179124000.0, 'cash_and_cash_equivalents__1': 114987000, 'current_net_receivables__1': 19128000.0, 'other_current_assets__1': 32443000, 'retained_earnings__1': 341964000, 'short_long_term_debt_total__1': 1394813000.0, 'total_liabilities__1': 1750247000, 'total_non_current_liabilities__1': 1366282000.0, 'common_stock_shares_outstanding__1': 100831000, 'property_plant_equipment__1': nan, 'inventory__1': 349993000, 'symbol__1': 'GO', 'short_term_investments__1': nan, 'cash_and_short_term_investments__1': 114987000, 'long_term_investments__1': nan, 'total_non_current_assets__1': 2453035000.0 ... 215 parameters truncated ... 'short_term_debt__7': 5384000, 'common_stock__7': 68000, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'treasury_stock__7': 0.0, 'deferred_revenue__7': nan, 'accumulated_depreciation_amortization_ppe__7': nan, 'goodwill__7': 747943000, 'long_term_debt__7': 705502000, 'current_accounts_payable__7': 95555000, 'total_shareholder_equity__7': 427133000, 'other_non_current_liabilities__7': nan, 'other_current_liabilities__7': 27367000, 'intangible_assets__7': 75664000, 'reported_currency__7': 'USD', 'capital_lease_obligations__7': nan, 'cash_and_cash_equivalents__8': 0, 'current_net_receivables__8': nan, 'other_current_assets__8': 0, 'retained_earnings__8': 0, 'short_long_term_debt_total__8': nan, 'total_liabilities__8': 0, 'total_non_current_liabilities__8': nan, 'common_stock_shares_outstanding__8': 74221000, 'property_plant_equipment__8': 0.0, 'inventory__8': 0, 'symbol__8': 'GO', 'short_term_investments__8': 0.0, 'cash_and_short_term_investments__8': 0, 'long_term_investments__8': 0.0, 'total_non_current_assets__8': nan, 'total_current_liabilities__8': 0, 'total_assets__8': 0, 'other_non_current_assets__8': nan, 'total_current_assets__8': 0, 'current_debt__8': nan, 'short_term_debt__8': 0, 'common_stock__8': 0, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'treasury_stock__8': 0.0, 'deferred_revenue__8': nan, 'accumulated_depreciation_amortization_ppe__8': nan, 'goodwill__8': 0, 'long_term_debt__8': 0, 'current_accounts_payable__8': 0, 'total_shareholder_equity__8': 0, 'other_non_current_liabilities__8': nan, 'other_current_liabilities__8': 0, 'intangible_assets__8': 0, 'reported_currency__8': 'USD', 'capital_lease_obligations__8': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,433 - AlphaLoader - ERROR - alphavantage_adapter.py:298 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "balance_sheet_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO balance_sheet_annual (symbol, fiscal_date_ending, reported_currency, total_assets, total_current_assets, cash_and_cash_equivalents, cash_and_short_term_investments, inventory, current_net_receivables, total_non_current_assets, property_pl ... 9782 characters truncated ... y_stock__8)s, %(retained_earnings__8)s, %(common_stock__8)s, %(common_stock_shares_outstanding__8)s)]
[parameters: {'cash_and_cash_equivalents__0': 62828000, 'current_net_receivables__0': 20217000.0, 'other_current_assets__0': 26701000, 'retained_earnings__0': 381429000, 'short_long_term_debt_total__0': 1656626000.0, 'total_liabilities__0': 1976437000, 'total_non_current_liabilities__0': 1626813000.0, 'common_stock_shares_outstanding__0': 99615000, 'property_plant_equipment__0': nan, 'inventory__0': 394152000, 'symbol__0': 'GO', 'short_term_investments__0': nan, 'cash_and_short_term_investments__0': 62828000, 'long_term_investments__0': nan, 'total_non_current_assets__0': 2669923000.0, 'total_current_liabilities__0': 349624000, 'total_assets__0': 3173821000, 'other_non_current_assets__0': nan, 'total_current_assets__0': 503898000, 'current_debt__0': nan, 'short_term_debt__0': 87905000, 'common_stock__0': 97000, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'treasury_stock__0': nan, 'deferred_revenue__0': nan, 'accumulated_depreciation_amortization_ppe__0': nan, 'goodwill__0': 782734000, 'long_term_debt__0': 462502000, 'current_accounts_payable__0': 175871000, 'total_shareholder_equity__0': 1197384000, 'other_non_current_liabilities__0': 1914000.0, 'other_current_liabilities__0': 74927000, 'intangible_assets__0': 78778000, 'reported_currency__0': 'USD', 'capital_lease_obligations__0': 1179124000.0, 'cash_and_cash_equivalents__1': 114987000, 'current_net_receivables__1': 19128000.0, 'other_current_assets__1': 32443000, 'retained_earnings__1': 341964000, 'short_long_term_debt_total__1': 1394813000.0, 'total_liabilities__1': 1750247000, 'total_non_current_liabilities__1': 1366282000.0, 'common_stock_shares_outstanding__1': 100831000, 'property_plant_equipment__1': nan, 'inventory__1': 349993000, 'symbol__1': 'GO', 'short_term_investments__1': nan, 'cash_and_short_term_investments__1': 114987000, 'long_term_investments__1': nan, 'total_non_current_assets__1': 2453035000.0 ... 215 parameters truncated ... 'short_term_debt__7': 5384000, 'common_stock__7': 68000, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'treasury_stock__7': 0.0, 'deferred_revenue__7': nan, 'accumulated_depreciation_amortization_ppe__7': nan, 'goodwill__7': 747943000, 'long_term_debt__7': 705502000, 'current_accounts_payable__7': 95555000, 'total_shareholder_equity__7': 427133000, 'other_non_current_liabilities__7': nan, 'other_current_liabilities__7': 27367000, 'intangible_assets__7': 75664000, 'reported_currency__7': 'USD', 'capital_lease_obligations__7': nan, 'cash_and_cash_equivalents__8': 0, 'current_net_receivables__8': nan, 'other_current_assets__8': 0, 'retained_earnings__8': 0, 'short_long_term_debt_total__8': nan, 'total_liabilities__8': 0, 'total_non_current_liabilities__8': nan, 'common_stock_shares_outstanding__8': 74221000, 'property_plant_equipment__8': 0.0, 'inventory__8': 0, 'symbol__8': 'GO', 'short_term_investments__8': 0.0, 'cash_and_short_term_investments__8': 0, 'long_term_investments__8': 0.0, 'total_non_current_assets__8': nan, 'total_current_liabilities__8': 0, 'total_assets__8': 0, 'other_non_current_assets__8': nan, 'total_current_assets__8': 0, 'current_debt__8': nan, 'short_term_debt__8': 0, 'common_stock__8': 0, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'treasury_stock__8': 0.0, 'deferred_revenue__8': nan, 'accumulated_depreciation_amortization_ppe__8': nan, 'goodwill__8': 0, 'long_term_debt__8': 0, 'current_accounts_payable__8': 0, 'total_shareholder_equity__8': 0, 'other_non_current_liabilities__8': nan, 'other_current_liabilities__8': 0, 'intangible_assets__8': 0, 'reported_currency__8': 'USD', 'capital_lease_obligations__8': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,433 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching CASH_FLOW data for GO...
2025-08-30 12:10:06,837 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into cash_flow_annual
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "cash_flow_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "cash_flow_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO cash_flow_annual (symbol, fiscal_date_ending, reported_currency, operating_cashflow, payments_for_operating_activities, proceeds_from_operating_activities, change_in_operating_liabilities, change_in_operating_assets, depreciation_depletio ... 10743 characters truncated ... _8)s, %(change_in_cash_and_cash_equivalents__8)s, %(change_in_exchange_rate__8)s, %(net_income__8)s)]
[parameters: {'dividend_payout_preferred_stock__0': nan, 'profit_loss__0': nan, 'change_in_operating_liabilities__0': nan, 'cashflow_from_financing__0': 109906000, 'change_in_cash_and_cash_equivalents__0': nan, 'proceeds_from_operating_activities__0': nan, 'symbol__0': 'GO', 'payments_for_operating_activities__0': nan, 'depreciation_depletion_and_amortization__0': 108206000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__0': nan, 'proceeds_from_issuance_of_common_stock__0': nan, 'dividend_payout__0': 0, 'net_income__0': 39465000, 'proceeds_from_sale_of_treasury_stock__0': nan, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'capital_expenditures__0': 186611000, 'proceeds_from_issuance_of_preferred_stock__0': nan, 'operating_cashflow__0': 111963000, 'change_in_receivables__0': nan, 'payments_for_repurchase_of_common_stock__0': nan, 'dividend_payout_common_stock__0': 0, 'change_in_exchange_rate__0': nan, 'proceeds_from_repurchase_of_equity__0': -81355000, 'change_in_operating_assets__0': nan, 'change_in_inventory__0': -29951000, 'proceeds_from_repayments_of_short_term_debt__0': nan, 'reported_currency__0': 'USD', 'payments_for_repurchase_of_equity__0': nan, 'cashflow_from_investment__0': -274028000, 'payments_for_repurchase_of_preferred_stock__0': nan, 'dividend_payout_preferred_stock__1': nan, 'profit_loss__1': nan, 'change_in_operating_liabilities__1': nan, 'cashflow_from_financing__1': -97023000, 'change_in_cash_and_cash_equivalents__1': nan, 'proceeds_from_operating_activities__1': nan, 'symbol__1': 'GO', 'payments_for_operating_activities__1': nan, 'depreciation_depletion_and_amortization__1': 87982000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__1': nan, 'proceeds_from_issuance_of_common_stock__1': nan, 'dividend_payout__1': 15000, 'net_income__1': 79437000, 'proceeds_from_sale_of_treasury_stock__1': nan, 'fiscal_date_ending__1': Timestamp('2023-12-31 00:00:00'), 'capital_expenditures__1': 191990000, 'proceeds_from_issuance_of_preferred_stock__1': nan, 'operating_cashflow__1': 303447000, 'change_in_receivables__1': nan, 'payments_for_repurchase_of_common_stock__1': nan ... 170 parameters truncated ... 'proceeds_from_issuance_of_common_stock__7': nan, 'dividend_payout__7': 1307000, 'net_income__7': 20601000, 'proceeds_from_sale_of_treasury_stock__7': nan, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'capital_expenditures__7': 74122000, 'proceeds_from_issuance_of_preferred_stock__7': nan, 'operating_cashflow__7': 84703000, 'change_in_receivables__7': nan, 'payments_for_repurchase_of_common_stock__7': nan, 'dividend_payout_common_stock__7': 1307000, 'change_in_exchange_rate__7': nan, 'proceeds_from_repurchase_of_equity__7': -172000, 'change_in_operating_assets__7': nan, 'change_in_inventory__7': -18202000, 'proceeds_from_repayments_of_short_term_debt__7': nan, 'reported_currency__7': 'USD', 'payments_for_repurchase_of_equity__7': nan, 'cashflow_from_investment__7': -77820000, 'payments_for_repurchase_of_preferred_stock__7': nan, 'dividend_payout_preferred_stock__8': nan, 'profit_loss__8': nan, 'change_in_operating_liabilities__8': nan, 'cashflow_from_financing__8': -4328000, 'change_in_cash_and_cash_equivalents__8': nan, 'proceeds_from_operating_activities__8': nan, 'symbol__8': 'GO', 'payments_for_operating_activities__8': nan, 'depreciation_depletion_and_amortization__8': 37152000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__8': nan, 'proceeds_from_issuance_of_common_stock__8': nan, 'dividend_payout__8': 86454000, 'net_income__8': 10198000, 'proceeds_from_sale_of_treasury_stock__8': nan, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'capital_expenditures__8': 62851000, 'proceeds_from_issuance_of_preferred_stock__8': nan, 'operating_cashflow__8': 70875000, 'change_in_receivables__8': nan, 'payments_for_repurchase_of_common_stock__8': nan, 'dividend_payout_common_stock__8': 86454000, 'change_in_exchange_rate__8': nan, 'proceeds_from_repurchase_of_equity__8': -253000, 'change_in_operating_assets__8': nan, 'change_in_inventory__8': -20439000, 'proceeds_from_repayments_of_short_term_debt__8': nan, 'reported_currency__8': 'USD', 'payments_for_repurchase_of_equity__8': nan, 'cashflow_from_investment__8': -65416000, 'payments_for_repurchase_of_preferred_stock__8': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,841 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "cash_flow_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "cash_flow_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO cash_flow_annual (symbol, fiscal_date_ending, reported_currency, operating_cashflow, payments_for_operating_activities, proceeds_from_operating_activities, change_in_operating_liabilities, change_in_operating_assets, depreciation_depletio ... 10743 characters truncated ... _8)s, %(change_in_cash_and_cash_equivalents__8)s, %(change_in_exchange_rate__8)s, %(net_income__8)s)]
[parameters: {'dividend_payout_preferred_stock__0': nan, 'profit_loss__0': nan, 'change_in_operating_liabilities__0': nan, 'cashflow_from_financing__0': 109906000, 'change_in_cash_and_cash_equivalents__0': nan, 'proceeds_from_operating_activities__0': nan, 'symbol__0': 'GO', 'payments_for_operating_activities__0': nan, 'depreciation_depletion_and_amortization__0': 108206000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__0': nan, 'proceeds_from_issuance_of_common_stock__0': nan, 'dividend_payout__0': 0, 'net_income__0': 39465000, 'proceeds_from_sale_of_treasury_stock__0': nan, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'capital_expenditures__0': 186611000, 'proceeds_from_issuance_of_preferred_stock__0': nan, 'operating_cashflow__0': 111963000, 'change_in_receivables__0': nan, 'payments_for_repurchase_of_common_stock__0': nan, 'dividend_payout_common_stock__0': 0, 'change_in_exchange_rate__0': nan, 'proceeds_from_repurchase_of_equity__0': -81355000, 'change_in_operating_assets__0': nan, 'change_in_inventory__0': -29951000, 'proceeds_from_repayments_of_short_term_debt__0': nan, 'reported_currency__0': 'USD', 'payments_for_repurchase_of_equity__0': nan, 'cashflow_from_investment__0': -274028000, 'payments_for_repurchase_of_preferred_stock__0': nan, 'dividend_payout_preferred_stock__1': nan, 'profit_loss__1': nan, 'change_in_operating_liabilities__1': nan, 'cashflow_from_financing__1': -97023000, 'change_in_cash_and_cash_equivalents__1': nan, 'proceeds_from_operating_activities__1': nan, 'symbol__1': 'GO', 'payments_for_operating_activities__1': nan, 'depreciation_depletion_and_amortization__1': 87982000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__1': nan, 'proceeds_from_issuance_of_common_stock__1': nan, 'dividend_payout__1': 15000, 'net_income__1': 79437000, 'proceeds_from_sale_of_treasury_stock__1': nan, 'fiscal_date_ending__1': Timestamp('2023-12-31 00:00:00'), 'capital_expenditures__1': 191990000, 'proceeds_from_issuance_of_preferred_stock__1': nan, 'operating_cashflow__1': 303447000, 'change_in_receivables__1': nan, 'payments_for_repurchase_of_common_stock__1': nan ... 170 parameters truncated ... 'proceeds_from_issuance_of_common_stock__7': nan, 'dividend_payout__7': 1307000, 'net_income__7': 20601000, 'proceeds_from_sale_of_treasury_stock__7': nan, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'capital_expenditures__7': 74122000, 'proceeds_from_issuance_of_preferred_stock__7': nan, 'operating_cashflow__7': 84703000, 'change_in_receivables__7': nan, 'payments_for_repurchase_of_common_stock__7': nan, 'dividend_payout_common_stock__7': 1307000, 'change_in_exchange_rate__7': nan, 'proceeds_from_repurchase_of_equity__7': -172000, 'change_in_operating_assets__7': nan, 'change_in_inventory__7': -18202000, 'proceeds_from_repayments_of_short_term_debt__7': nan, 'reported_currency__7': 'USD', 'payments_for_repurchase_of_equity__7': nan, 'cashflow_from_investment__7': -77820000, 'payments_for_repurchase_of_preferred_stock__7': nan, 'dividend_payout_preferred_stock__8': nan, 'profit_loss__8': nan, 'change_in_operating_liabilities__8': nan, 'cashflow_from_financing__8': -4328000, 'change_in_cash_and_cash_equivalents__8': nan, 'proceeds_from_operating_activities__8': nan, 'symbol__8': 'GO', 'payments_for_operating_activities__8': nan, 'depreciation_depletion_and_amortization__8': 37152000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__8': nan, 'proceeds_from_issuance_of_common_stock__8': nan, 'dividend_payout__8': 86454000, 'net_income__8': 10198000, 'proceeds_from_sale_of_treasury_stock__8': nan, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'capital_expenditures__8': 62851000, 'proceeds_from_issuance_of_preferred_stock__8': nan, 'operating_cashflow__8': 70875000, 'change_in_receivables__8': nan, 'payments_for_repurchase_of_common_stock__8': nan, 'dividend_payout_common_stock__8': 86454000, 'change_in_exchange_rate__8': nan, 'proceeds_from_repurchase_of_equity__8': -253000, 'change_in_operating_assets__8': nan, 'change_in_inventory__8': -20439000, 'proceeds_from_repayments_of_short_term_debt__8': nan, 'reported_currency__8': 'USD', 'payments_for_repurchase_of_equity__8': nan, 'cashflow_from_investment__8': -65416000, 'payments_for_repurchase_of_preferred_stock__8': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,844 - AlphaLoader - ERROR - alphavantage_adapter.py:298 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "cash_flow_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2024-12-31) already exists.

[SQL: INSERT INTO cash_flow_annual (symbol, fiscal_date_ending, reported_currency, operating_cashflow, payments_for_operating_activities, proceeds_from_operating_activities, change_in_operating_liabilities, change_in_operating_assets, depreciation_depletio ... 10743 characters truncated ... _8)s, %(change_in_cash_and_cash_equivalents__8)s, %(change_in_exchange_rate__8)s, %(net_income__8)s)]
[parameters: {'dividend_payout_preferred_stock__0': nan, 'profit_loss__0': nan, 'change_in_operating_liabilities__0': nan, 'cashflow_from_financing__0': 109906000, 'change_in_cash_and_cash_equivalents__0': nan, 'proceeds_from_operating_activities__0': nan, 'symbol__0': 'GO', 'payments_for_operating_activities__0': nan, 'depreciation_depletion_and_amortization__0': 108206000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__0': nan, 'proceeds_from_issuance_of_common_stock__0': nan, 'dividend_payout__0': 0, 'net_income__0': 39465000, 'proceeds_from_sale_of_treasury_stock__0': nan, 'fiscal_date_ending__0': Timestamp('2024-12-31 00:00:00'), 'capital_expenditures__0': 186611000, 'proceeds_from_issuance_of_preferred_stock__0': nan, 'operating_cashflow__0': 111963000, 'change_in_receivables__0': nan, 'payments_for_repurchase_of_common_stock__0': nan, 'dividend_payout_common_stock__0': 0, 'change_in_exchange_rate__0': nan, 'proceeds_from_repurchase_of_equity__0': -81355000, 'change_in_operating_assets__0': nan, 'change_in_inventory__0': -29951000, 'proceeds_from_repayments_of_short_term_debt__0': nan, 'reported_currency__0': 'USD', 'payments_for_repurchase_of_equity__0': nan, 'cashflow_from_investment__0': -274028000, 'payments_for_repurchase_of_preferred_stock__0': nan, 'dividend_payout_preferred_stock__1': nan, 'profit_loss__1': nan, 'change_in_operating_liabilities__1': nan, 'cashflow_from_financing__1': -97023000, 'change_in_cash_and_cash_equivalents__1': nan, 'proceeds_from_operating_activities__1': nan, 'symbol__1': 'GO', 'payments_for_operating_activities__1': nan, 'depreciation_depletion_and_amortization__1': 87982000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__1': nan, 'proceeds_from_issuance_of_common_stock__1': nan, 'dividend_payout__1': 15000, 'net_income__1': 79437000, 'proceeds_from_sale_of_treasury_stock__1': nan, 'fiscal_date_ending__1': Timestamp('2023-12-31 00:00:00'), 'capital_expenditures__1': 191990000, 'proceeds_from_issuance_of_preferred_stock__1': nan, 'operating_cashflow__1': 303447000, 'change_in_receivables__1': nan, 'payments_for_repurchase_of_common_stock__1': nan ... 170 parameters truncated ... 'proceeds_from_issuance_of_common_stock__7': nan, 'dividend_payout__7': 1307000, 'net_income__7': 20601000, 'proceeds_from_sale_of_treasury_stock__7': nan, 'fiscal_date_ending__7': Timestamp('2017-12-31 00:00:00'), 'capital_expenditures__7': 74122000, 'proceeds_from_issuance_of_preferred_stock__7': nan, 'operating_cashflow__7': 84703000, 'change_in_receivables__7': nan, 'payments_for_repurchase_of_common_stock__7': nan, 'dividend_payout_common_stock__7': 1307000, 'change_in_exchange_rate__7': nan, 'proceeds_from_repurchase_of_equity__7': -172000, 'change_in_operating_assets__7': nan, 'change_in_inventory__7': -18202000, 'proceeds_from_repayments_of_short_term_debt__7': nan, 'reported_currency__7': 'USD', 'payments_for_repurchase_of_equity__7': nan, 'cashflow_from_investment__7': -77820000, 'payments_for_repurchase_of_preferred_stock__7': nan, 'dividend_payout_preferred_stock__8': nan, 'profit_loss__8': nan, 'change_in_operating_liabilities__8': nan, 'cashflow_from_financing__8': -4328000, 'change_in_cash_and_cash_equivalents__8': nan, 'proceeds_from_operating_activities__8': nan, 'symbol__8': 'GO', 'payments_for_operating_activities__8': nan, 'depreciation_depletion_and_amortization__8': 37152000, 'proceeds_from_issuance_of_long_term_debt_and_capital_securities_net__8': nan, 'proceeds_from_issuance_of_common_stock__8': nan, 'dividend_payout__8': 86454000, 'net_income__8': 10198000, 'proceeds_from_sale_of_treasury_stock__8': nan, 'fiscal_date_ending__8': Timestamp('2016-12-31 00:00:00'), 'capital_expenditures__8': 62851000, 'proceeds_from_issuance_of_preferred_stock__8': nan, 'operating_cashflow__8': 70875000, 'change_in_receivables__8': nan, 'payments_for_repurchase_of_common_stock__8': nan, 'dividend_payout_common_stock__8': 86454000, 'change_in_exchange_rate__8': nan, 'proceeds_from_repurchase_of_equity__8': -253000, 'change_in_operating_assets__8': nan, 'change_in_inventory__8': -20439000, 'proceeds_from_repayments_of_short_term_debt__8': nan, 'reported_currency__8': 'USD', 'payments_for_repurchase_of_equity__8': nan, 'cashflow_from_investment__8': -65416000, 'payments_for_repurchase_of_preferred_stock__8': nan}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:06,844 - AlphaLoader - INFO - alphavantage_adapter.py:203 - Fetching EARNINGS data for GO...
2025-08-30 12:10:07,334 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into earnings_annual
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "earnings_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2025-06-30) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "earnings_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2025-06-30) already exists.

[SQL: INSERT INTO earnings_annual (symbol, fiscal_date_ending, reported_eps) VALUES (%(symbol__0)s, %(fiscal_date_ending__0)s, %(reported_eps__0)s), (%(symbol__1)s, %(fiscal_date_ending__1)s, %(reported_eps__1)s), (%(symbol__2)s, %(fiscal_date_ending__2)s, ... 181 characters truncated ... e_ending__5)s, %(reported_eps__5)s), (%(symbol__6)s, %(fiscal_date_ending__6)s, %(reported_eps__6)s)]
[parameters: {'reported_eps__0': 0.36, 'symbol__0': 'GO', 'fiscal_date_ending__0': Timestamp('2025-06-30 00:00:00'), 'reported_eps__1': 0.77, 'symbol__1': 'GO', 'fiscal_date_ending__1': Timestamp('2024-12-31 00:00:00'), 'reported_eps__2': 1.08, 'symbol__2': 'GO', 'fiscal_date_ending__2': Timestamp('2023-12-31 00:00:00'), 'reported_eps__3': 1.03, 'symbol__3': 'GO', 'fiscal_date_ending__3': Timestamp('2022-12-31 00:00:00'), 'reported_eps__4': 0.9, 'symbol__4': 'GO', 'fiscal_date_ending__4': Timestamp('2021-12-31 00:00:00'), 'reported_eps__5': 1.52, 'symbol__5': 'GO', 'fiscal_date_ending__5': Timestamp('2020-12-31 00:00:00'), 'reported_eps__6': 0.82, 'symbol__6': 'GO', 'fiscal_date_ending__6': Timestamp('2019-12-31 00:00:00')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:07,336 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "earnings_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2025-06-30) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "earnings_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2025-06-30) already exists.

[SQL: INSERT INTO earnings_annual (symbol, fiscal_date_ending, reported_eps) VALUES (%(symbol__0)s, %(fiscal_date_ending__0)s, %(reported_eps__0)s), (%(symbol__1)s, %(fiscal_date_ending__1)s, %(reported_eps__1)s), (%(symbol__2)s, %(fiscal_date_ending__2)s, ... 181 characters truncated ... e_ending__5)s, %(reported_eps__5)s), (%(symbol__6)s, %(fiscal_date_ending__6)s, %(reported_eps__6)s)]
[parameters: {'reported_eps__0': 0.36, 'symbol__0': 'GO', 'fiscal_date_ending__0': Timestamp('2025-06-30 00:00:00'), 'reported_eps__1': 0.77, 'symbol__1': 'GO', 'fiscal_date_ending__1': Timestamp('2024-12-31 00:00:00'), 'reported_eps__2': 1.08, 'symbol__2': 'GO', 'fiscal_date_ending__2': Timestamp('2023-12-31 00:00:00'), 'reported_eps__3': 1.03, 'symbol__3': 'GO', 'fiscal_date_ending__3': Timestamp('2022-12-31 00:00:00'), 'reported_eps__4': 0.9, 'symbol__4': 'GO', 'fiscal_date_ending__4': Timestamp('2021-12-31 00:00:00'), 'reported_eps__5': 1.52, 'symbol__5': 'GO', 'fiscal_date_ending__5': Timestamp('2020-12-31 00:00:00'), 'reported_eps__6': 0.82, 'symbol__6': 'GO', 'fiscal_date_ending__6': Timestamp('2019-12-31 00:00:00')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:07,338 - AlphaLoader - ERROR - alphavantage_adapter.py:298 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "earnings_annual_pkey"
DETAIL:  Key (symbol, fiscal_date_ending)=(GO, 2025-06-30) already exists.

[SQL: INSERT INTO earnings_annual (symbol, fiscal_date_ending, reported_eps) VALUES (%(symbol__0)s, %(fiscal_date_ending__0)s, %(reported_eps__0)s), (%(symbol__1)s, %(fiscal_date_ending__1)s, %(reported_eps__1)s), (%(symbol__2)s, %(fiscal_date_ending__2)s, ... 181 characters truncated ... e_ending__5)s, %(reported_eps__5)s), (%(symbol__6)s, %(fiscal_date_ending__6)s, %(reported_eps__6)s)]
[parameters: {'reported_eps__0': 0.36, 'symbol__0': 'GO', 'fiscal_date_ending__0': Timestamp('2025-06-30 00:00:00'), 'reported_eps__1': 0.77, 'symbol__1': 'GO', 'fiscal_date_ending__1': Timestamp('2024-12-31 00:00:00'), 'reported_eps__2': 1.08, 'symbol__2': 'GO', 'fiscal_date_ending__2': Timestamp('2023-12-31 00:00:00'), 'reported_eps__3': 1.03, 'symbol__3': 'GO', 'fiscal_date_ending__3': Timestamp('2022-12-31 00:00:00'), 'reported_eps__4': 0.9, 'symbol__4': 'GO', 'fiscal_date_ending__4': Timestamp('2021-12-31 00:00:00'), 'reported_eps__5': 1.52, 'symbol__5': 'GO', 'fiscal_date_ending__5': Timestamp('2020-12-31 00:00:00'), 'reported_eps__6': 0.82, 'symbol__6': 'GO', 'fiscal_date_ending__6': Timestamp('2019-12-31 00:00:00')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:07,338 - AlphaLoader - INFO - alphavantage_adapter.py:305 - Fetching INSIDER_TRANSACTIONS data for GO...
2025-08-30 12:10:08,031 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:248 - Failed to insert new rows into insider_transactions
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "insider_transactions_pkey"
DETAIL:  Key (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal)=(2025-08-15, GO, WILSON, STEVEN K., EVP, Chief Purchasing Officer, Common Stock, D) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "insider_transactions_pkey"
DETAIL:  Key (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal)=(2025-08-15, GO, WILSON, STEVEN K., EVP, Chief Purchasing Officer, Common Stock, D) already exists.

[SQL: INSERT INTO insider_transactions (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal, shares, share_price) VALUES (%(transaction_date__0)s, %(symbol__0)s, %(executive__0)s, %(executive_title__0)s, %(security_ ... 169213 characters truncated ... )s, %(security_type__900)s, %(acquisition_or_disposal__900)s, %(shares__900)s, %(share_price__900)s)]
[parameters: {'acquisition_or_disposal__0': 'D', 'shares__0': 5000.0, 'symbol__0': 'GO', 'executive_title__0': 'EVP, Chief Purchasing Officer', 'security_type__0': 'Common Stock', 'share_price__0': 18.24, 'transaction_date__0': Timestamp('2025-08-15 00:00:00'), 'executive__0': 'WILSON, STEVEN K.', 'acquisition_or_disposal__1': 'D', 'shares__1': 20000.0, 'symbol__1': 'GO', 'executive_title__1': 'EVP, Chief Purchasing Officer', 'security_type__1': 'Common Stock', 'share_price__1': 19.2, 'transaction_date__1': Timestamp('2025-08-08 00:00:00'), 'executive__1': 'WILSON, STEVEN K.', 'acquisition_or_disposal__2': 'A', 'shares__2': 26743.0, 'symbol__2': 'GO', 'executive_title__2': 'See Remarks', 'security_type__2': 'Stock Options (Right to Buy)', 'share_price__2': 0.0, 'transaction_date__2': Timestamp('2025-08-07 00:00:00'), 'executive__2': 'DELLY, MATTHEW PATRICK', 'acquisition_or_disposal__3': 'A', 'shares__3': 11839.0, 'symbol__3': 'GO', 'executive_title__3': 'Director', 'security_type__3': 'Common Stock', 'share_price__3': 12.67, 'transaction_date__3': Timestamp('2025-06-26 00:00:00'), 'executive__3': 'MOLLOY, LAWRENCE', 'acquisition_or_disposal__4': 'A', 'shares__4': 11839.0, 'symbol__4': 'GO', 'executive_title__4': 'Director', 'security_type__4': 'Common Stock', 'share_price__4': 12.67, 'transaction_date__4': Timestamp('2025-06-26 00:00:00'), 'executive__4': 'KOBAYASHI, MICHAEL K', 'acquisition_or_disposal__5': 'A', 'shares__5': 10692.0, 'symbol__5': 'GO', 'executive_title__5': 'Director', 'security_type__5': 'Common Stock', 'share_price__5': 0.0, 'transaction_date__5': Timestamp('2025-06-03 00:00:00'), 'executive__5': 'LINDBERG, ERIC J. JR.', 'acquisition_or_disposal__6': 'A', 'shares__6': 10692.0 ... 7108 parameters truncated ... 'transaction_date__894': Timestamp('2020-02-03 00:00:00'), 'executive__894': 'H&AMP;F, CORPORATE INVESTORS VII, LTD.', 'acquisition_or_disposal__895': 'A', 'shares__895': 960240.0, 'symbol__895': 'GO', 'executive_title__895': 'Director, Chief Executive Officer', 'security_type__895': 'Stock Options (Right to Buy)', 'share_price__895': 0.0, 'transaction_date__895': Timestamp('2020-02-03 00:00:00'), 'executive__895': 'LINDBERG, ERIC J. JR.', 'acquisition_or_disposal__896': 'D', 'shares__896': 25000.0, 'symbol__896': 'GO', 'executive_title__896': 'Director', 'security_type__896': 'Common Stock', 'share_price__896': 31.845, 'transaction_date__896': Timestamp('2020-02-03 00:00:00'), 'executive__896': 'YORK, JEFFREY', 'acquisition_or_disposal__897': 'A', 'shares__897': 960240.0, 'symbol__897': 'GO', 'executive_title__897': 'Director, Vice Chairman', 'security_type__897': 'Stock Options (Right to Buy)', 'share_price__897': 0.0, 'transaction_date__897': Timestamp('2020-02-03 00:00:00'), 'executive__897': 'READ, S. MACGREGOR JR.', 'acquisition_or_disposal__898': 'A', 'shares__898': 24808.0, 'symbol__898': 'GO', 'executive_title__898': 'VP Corporate Controller', 'security_type__898': 'Stock Options (Right to Buy)', 'share_price__898': 0.0, 'transaction_date__898': Timestamp('2020-02-03 00:00:00'), 'executive__898': 'GRAY, LINDSAY E.', 'acquisition_or_disposal__899': 'D', 'shares__899': 9400.0, 'symbol__899': 'GO', 'executive_title__899': 'Director', 'security_type__899': 'Common Stock', 'share_price__899': 0.0, 'transaction_date__899': Timestamp('2020-01-24 00:00:00'), 'executive__899': 'HERMAN, THOMAS F', 'acquisition_or_disposal__900': 'A', 'shares__900': 9400.0, 'symbol__900': 'GO', 'executive_title__900': 'Director', 'security_type__900': 'Common Stock', 'share_price__900': 0.0, 'transaction_date__900': Timestamp('2020-01-24 00:00:00'), 'executive__900': 'HERMAN, THOMAS F'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:08,035 - data_manager.src_postgre_db.db_infrastructure.postgre_adapter - ERROR - postgre_adapter.py:91 - Transaction failed
Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "insider_transactions_pkey"
DETAIL:  Key (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal)=(2025-08-15, GO, WILSON, STEVEN K., EVP, Chief Purchasing Officer, Common Stock, D) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 86, in session_scope
    yield session
  File "/home/bandee/projects/marketIntelligence/data_manager/src_postgre_db/db_infrastructure/postgre_adapter.py", line 241, in insert_new_data
    session.bulk_insert_mappings(table, rows)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4669, in bulk_insert_mappings
    self._bulk_save_mappings(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<5 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4763, in _bulk_save_mappings
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4752, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        mapper,
        ^^^^^^^
    ...<4 lines>...
        render_nulls=render_nulls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
        base_mapper,
    ...<6 lines>...
        execution_options=execution_options,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1841, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2123, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2115, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "/home/bandee/projects/marketIntelligence/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "insider_transactions_pkey"
DETAIL:  Key (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal)=(2025-08-15, GO, WILSON, STEVEN K., EVP, Chief Purchasing Officer, Common Stock, D) already exists.

[SQL: INSERT INTO insider_transactions (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal, shares, share_price) VALUES (%(transaction_date__0)s, %(symbol__0)s, %(executive__0)s, %(executive_title__0)s, %(security_ ... 169213 characters truncated ... )s, %(security_type__900)s, %(acquisition_or_disposal__900)s, %(shares__900)s, %(share_price__900)s)]
[parameters: {'acquisition_or_disposal__0': 'D', 'shares__0': 5000.0, 'symbol__0': 'GO', 'executive_title__0': 'EVP, Chief Purchasing Officer', 'security_type__0': 'Common Stock', 'share_price__0': 18.24, 'transaction_date__0': Timestamp('2025-08-15 00:00:00'), 'executive__0': 'WILSON, STEVEN K.', 'acquisition_or_disposal__1': 'D', 'shares__1': 20000.0, 'symbol__1': 'GO', 'executive_title__1': 'EVP, Chief Purchasing Officer', 'security_type__1': 'Common Stock', 'share_price__1': 19.2, 'transaction_date__1': Timestamp('2025-08-08 00:00:00'), 'executive__1': 'WILSON, STEVEN K.', 'acquisition_or_disposal__2': 'A', 'shares__2': 26743.0, 'symbol__2': 'GO', 'executive_title__2': 'See Remarks', 'security_type__2': 'Stock Options (Right to Buy)', 'share_price__2': 0.0, 'transaction_date__2': Timestamp('2025-08-07 00:00:00'), 'executive__2': 'DELLY, MATTHEW PATRICK', 'acquisition_or_disposal__3': 'A', 'shares__3': 11839.0, 'symbol__3': 'GO', 'executive_title__3': 'Director', 'security_type__3': 'Common Stock', 'share_price__3': 12.67, 'transaction_date__3': Timestamp('2025-06-26 00:00:00'), 'executive__3': 'MOLLOY, LAWRENCE', 'acquisition_or_disposal__4': 'A', 'shares__4': 11839.0, 'symbol__4': 'GO', 'executive_title__4': 'Director', 'security_type__4': 'Common Stock', 'share_price__4': 12.67, 'transaction_date__4': Timestamp('2025-06-26 00:00:00'), 'executive__4': 'KOBAYASHI, MICHAEL K', 'acquisition_or_disposal__5': 'A', 'shares__5': 10692.0, 'symbol__5': 'GO', 'executive_title__5': 'Director', 'security_type__5': 'Common Stock', 'share_price__5': 0.0, 'transaction_date__5': Timestamp('2025-06-03 00:00:00'), 'executive__5': 'LINDBERG, ERIC J. JR.', 'acquisition_or_disposal__6': 'A', 'shares__6': 10692.0 ... 7108 parameters truncated ... 'transaction_date__894': Timestamp('2020-02-03 00:00:00'), 'executive__894': 'H&AMP;F, CORPORATE INVESTORS VII, LTD.', 'acquisition_or_disposal__895': 'A', 'shares__895': 960240.0, 'symbol__895': 'GO', 'executive_title__895': 'Director, Chief Executive Officer', 'security_type__895': 'Stock Options (Right to Buy)', 'share_price__895': 0.0, 'transaction_date__895': Timestamp('2020-02-03 00:00:00'), 'executive__895': 'LINDBERG, ERIC J. JR.', 'acquisition_or_disposal__896': 'D', 'shares__896': 25000.0, 'symbol__896': 'GO', 'executive_title__896': 'Director', 'security_type__896': 'Common Stock', 'share_price__896': 31.845, 'transaction_date__896': Timestamp('2020-02-03 00:00:00'), 'executive__896': 'YORK, JEFFREY', 'acquisition_or_disposal__897': 'A', 'shares__897': 960240.0, 'symbol__897': 'GO', 'executive_title__897': 'Director, Vice Chairman', 'security_type__897': 'Stock Options (Right to Buy)', 'share_price__897': 0.0, 'transaction_date__897': Timestamp('2020-02-03 00:00:00'), 'executive__897': 'READ, S. MACGREGOR JR.', 'acquisition_or_disposal__898': 'A', 'shares__898': 24808.0, 'symbol__898': 'GO', 'executive_title__898': 'VP Corporate Controller', 'security_type__898': 'Stock Options (Right to Buy)', 'share_price__898': 0.0, 'transaction_date__898': Timestamp('2020-02-03 00:00:00'), 'executive__898': 'GRAY, LINDSAY E.', 'acquisition_or_disposal__899': 'D', 'shares__899': 9400.0, 'symbol__899': 'GO', 'executive_title__899': 'Director', 'security_type__899': 'Common Stock', 'share_price__899': 0.0, 'transaction_date__899': Timestamp('2020-01-24 00:00:00'), 'executive__899': 'HERMAN, THOMAS F', 'acquisition_or_disposal__900': 'A', 'shares__900': 9400.0, 'symbol__900': 'GO', 'executive_title__900': 'Director', 'security_type__900': 'Common Stock', 'share_price__900': 0.0, 'transaction_date__900': Timestamp('2020-01-24 00:00:00'), 'executive__900': 'HERMAN, THOMAS F'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:08,037 - AlphaLoader - ERROR - alphavantage_adapter.py:345 - An unexpected error occurred: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "insider_transactions_pkey"
DETAIL:  Key (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal)=(2025-08-15, GO, WILSON, STEVEN K., EVP, Chief Purchasing Officer, Common Stock, D) already exists.

[SQL: INSERT INTO insider_transactions (transaction_date, symbol, executive, executive_title, security_type, acquisition_or_disposal, shares, share_price) VALUES (%(transaction_date__0)s, %(symbol__0)s, %(executive__0)s, %(executive_title__0)s, %(security_ ... 169213 characters truncated ... )s, %(security_type__900)s, %(acquisition_or_disposal__900)s, %(shares__900)s, %(share_price__900)s)]
[parameters: {'acquisition_or_disposal__0': 'D', 'shares__0': 5000.0, 'symbol__0': 'GO', 'executive_title__0': 'EVP, Chief Purchasing Officer', 'security_type__0': 'Common Stock', 'share_price__0': 18.24, 'transaction_date__0': Timestamp('2025-08-15 00:00:00'), 'executive__0': 'WILSON, STEVEN K.', 'acquisition_or_disposal__1': 'D', 'shares__1': 20000.0, 'symbol__1': 'GO', 'executive_title__1': 'EVP, Chief Purchasing Officer', 'security_type__1': 'Common Stock', 'share_price__1': 19.2, 'transaction_date__1': Timestamp('2025-08-08 00:00:00'), 'executive__1': 'WILSON, STEVEN K.', 'acquisition_or_disposal__2': 'A', 'shares__2': 26743.0, 'symbol__2': 'GO', 'executive_title__2': 'See Remarks', 'security_type__2': 'Stock Options (Right to Buy)', 'share_price__2': 0.0, 'transaction_date__2': Timestamp('2025-08-07 00:00:00'), 'executive__2': 'DELLY, MATTHEW PATRICK', 'acquisition_or_disposal__3': 'A', 'shares__3': 11839.0, 'symbol__3': 'GO', 'executive_title__3': 'Director', 'security_type__3': 'Common Stock', 'share_price__3': 12.67, 'transaction_date__3': Timestamp('2025-06-26 00:00:00'), 'executive__3': 'MOLLOY, LAWRENCE', 'acquisition_or_disposal__4': 'A', 'shares__4': 11839.0, 'symbol__4': 'GO', 'executive_title__4': 'Director', 'security_type__4': 'Common Stock', 'share_price__4': 12.67, 'transaction_date__4': Timestamp('2025-06-26 00:00:00'), 'executive__4': 'KOBAYASHI, MICHAEL K', 'acquisition_or_disposal__5': 'A', 'shares__5': 10692.0, 'symbol__5': 'GO', 'executive_title__5': 'Director', 'security_type__5': 'Common Stock', 'share_price__5': 0.0, 'transaction_date__5': Timestamp('2025-06-03 00:00:00'), 'executive__5': 'LINDBERG, ERIC J. JR.', 'acquisition_or_disposal__6': 'A', 'shares__6': 10692.0 ... 7108 parameters truncated ... 'transaction_date__894': Timestamp('2020-02-03 00:00:00'), 'executive__894': 'H&AMP;F, CORPORATE INVESTORS VII, LTD.', 'acquisition_or_disposal__895': 'A', 'shares__895': 960240.0, 'symbol__895': 'GO', 'executive_title__895': 'Director, Chief Executive Officer', 'security_type__895': 'Stock Options (Right to Buy)', 'share_price__895': 0.0, 'transaction_date__895': Timestamp('2020-02-03 00:00:00'), 'executive__895': 'LINDBERG, ERIC J. JR.', 'acquisition_or_disposal__896': 'D', 'shares__896': 25000.0, 'symbol__896': 'GO', 'executive_title__896': 'Director', 'security_type__896': 'Common Stock', 'share_price__896': 31.845, 'transaction_date__896': Timestamp('2020-02-03 00:00:00'), 'executive__896': 'YORK, JEFFREY', 'acquisition_or_disposal__897': 'A', 'shares__897': 960240.0, 'symbol__897': 'GO', 'executive_title__897': 'Director, Vice Chairman', 'security_type__897': 'Stock Options (Right to Buy)', 'share_price__897': 0.0, 'transaction_date__897': Timestamp('2020-02-03 00:00:00'), 'executive__897': 'READ, S. MACGREGOR JR.', 'acquisition_or_disposal__898': 'A', 'shares__898': 24808.0, 'symbol__898': 'GO', 'executive_title__898': 'VP Corporate Controller', 'security_type__898': 'Stock Options (Right to Buy)', 'share_price__898': 0.0, 'transaction_date__898': Timestamp('2020-02-03 00:00:00'), 'executive__898': 'GRAY, LINDSAY E.', 'acquisition_or_disposal__899': 'D', 'shares__899': 9400.0, 'symbol__899': 'GO', 'executive_title__899': 'Director', 'security_type__899': 'Common Stock', 'share_price__899': 0.0, 'transaction_date__899': Timestamp('2020-01-24 00:00:00'), 'executive__899': 'HERMAN, THOMAS F', 'acquisition_or_disposal__900': 'A', 'shares__900': 9400.0, 'symbol__900': 'GO', 'executive_title__900': 'Director', 'security_type__900': 'Common Stock', 'share_price__900': 0.0, 'transaction_date__900': Timestamp('2020-01-24 00:00:00'), 'executive__900': 'HERMAN, THOMAS F'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-30 12:10:08,038 - AlphaLoader - INFO - alphavantage_adapter.py:352 - Fetching STOCK_SPLITS data for GO...
2025-08-30 12:10:08,285 - AlphaLoader - ERROR - alphavantage_adapter.py:390 - An unexpected error occurred: 'effective_date'
2025-08-30 12:10:08,286 - AlphaLoader - INFO - alphavantage_adapter.py:397 - Fetching DIVIDENDS data for GO...
2025-08-30 12:10:08,695 - AlphaLoader - ERROR - alphavantage_adapter.py:435 - An unexpected error occurred: 'ex_dividend_date'
2025-08-30 12:10:08,695 - db_initial_load_runner - INFO - db_initial_load_runner.py:77 - Initial loader finished its running.
2025-08-30 12:10:08,695 - db_load_from_db_runner - INFO - symbol.py:161 - Called load_stock_data for symbol: GO
2025-08-30 12:10:08,696 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1 filtered rows from company_fundamentals
2025-08-30 12:10:08,700 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 9 filtered rows from balance_sheet_annual
2025-08-30 12:10:08,700 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'balance_sheet_annual' with 9 rows.
2025-08-30 12:10:08,702 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 9 filtered rows from cash_flow_annual
2025-08-30 12:10:08,702 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'cash_flow_annual' with 9 rows.
2025-08-30 12:10:08,703 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 7 filtered rows from earnings_annual
2025-08-30 12:10:08,704 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'earnings_annual' with 7 rows.
2025-08-30 12:10:08,707 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 9 filtered rows from income_statement_annual
2025-08-30 12:10:08,708 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'income_statement_annual' with 9 rows.
2025-08-30 12:10:08,709 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1 filtered rows from company_fundamentals
2025-08-30 12:10:08,711 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'company_fundamentals' with 1 rows.
2025-08-30 12:10:08,722 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 1558 filtered rows from daily_timeseries
2025-08-30 12:10:08,732 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'daily_timeseries' with 1558 rows.
2025-08-30 12:10:08,734 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from dividends
2025-08-30 12:10:08,736 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'dividends' with 0 rows.
2025-08-30 12:10:08,840 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 520 filtered rows from insider_transactions
2025-08-30 12:10:08,843 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'insider_transactions' with 520 rows.
2025-08-30 12:10:08,845 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 30 filtered rows from balance_sheet_quarterly
2025-08-30 12:10:08,846 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'balance_sheet_quarterly' with 30 rows.
2025-08-30 12:10:08,849 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 30 filtered rows from cash_flow_quarterly
2025-08-30 12:10:08,850 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'cash_flow_quarterly' with 30 rows.
2025-08-30 12:10:08,853 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 26 filtered rows from earnings_quarterly
2025-08-30 12:10:08,854 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'earnings_quarterly' with 26 rows.
2025-08-30 12:10:08,857 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 30 filtered rows from income_statement_quarterly
2025-08-30 12:10:08,858 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'income_statement_quarterly' with 30 rows.
2025-08-30 12:10:08,860 - infrastructure.databases.company.postgre_manager.postgre_manager - INFO - postgre_manager.py:461 - Loaded 0 filtered rows from stock_splits
2025-08-30 12:10:08,862 - db_load_from_db_runner - INFO - symbol.py:194 - Loaded table 'stock_splits' with 0 rows.
2025-08-30 12:10:08,862 - db_load_from_db_runner - WARNING - symbol.py:184 - ORM class for table 'cash_flow_statement_quarterly' not found. Skipping.
2025-08-30 12:10:08,863 - db_load_from_db_runner - ERROR - symbol.py:135 - Error adjusting prices for splits: 'symbol'
2025-08-30 12:10:08,894 - db_load_from_db_runner - INFO - symbol.py:246 - All price indicators added to daily_timeseries.
